<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC ‡∏à.‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£ - ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ ‡∏†‡∏Å.‡∏à‡∏µ‡∏£‡∏†‡∏±‡∏ó‡∏£ ‡∏û‡∏•‡∏≤‡∏¢‡∏á‡∏≤‡∏°</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- UMD Guard -->
    <script>
        window.module = undefined;
        window.exports = undefined;
        window.define = undefined;
    </script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/17.0.2/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/17.0.2/umd/react-dom.production.min.js"></script>
    
    <!-- Dependencies for Recharts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prop-types/15.8.1/prop-types.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/classnames/2.3.2/index.min.js"></script>

    <!-- Recharts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.1.12/Recharts.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Lodash -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>

    <!-- html2pdf.js for PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        body {
            font-family: 'Sarabun', sans-serif;
        }
        /* Custom Scrollbar (Blue Theme) */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f0f9ff; /* sky-50 */
        }
        ::-webkit-scrollbar-thumb {
            background: #7dd3fc; /* sky-300 */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #38bdf8; /* sky-400 */
        }

        /* Print Styles for PDF Generation */
        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { background: white; }
            .card { box-shadow: none; border: 1px solid #ddd; break-inside: avoid; }
            .page-break { page-break-after: always; }
        }
        .print-only { display: none; }
    </style>
</head>
<body class="bg-sky-50 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useRef } = React;
        const _ = window._;
        
        const RechartsLib = window.Recharts || (window.Recharts && window.Recharts.default);
        const { 
            PieChart, Pie, Cell, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip: RechartsTooltip, Legend, ResponsiveContainer, LineChart, Line, ComposedChart 
        } = RechartsLib;

        // --- Icons ---
        const ICONS = {
            Dashboard: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>,
            Map: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" x2="9" y1="3" y2="18"/><line x1="15" x2="15" y1="6" y2="21"/></svg>,
            Hospital: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 6V4"/><path d="M16.5 4h-9"/><path d="M18 22v-5"/><path d="M6 22v-5"/><path d="M12 12v5"/><path d="M12 17h-5"/><path d="M12 17h5"/><rect x="4" y="8" width="16" height="14" rx="2"/></svg>,
            Calculator: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>,
            Upload: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>,
            Menu: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>,
            TrendingUp: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>,
            CheckCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>,
            AlertCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>,
            Download: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>,
            Search: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" x2="16.65" y1="21" y2="16.65"/></svg>,
            Lightbulb: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>,
            Award: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>,
            Printer: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>,
            ChevronRight: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
        };

        const COLORS = ['#0EA5E9', '#3B82F6', '#06B6D4', '#6366F1', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6'];
        
        // --- DATA SECTION ---
        const PROVINCIAL_DATA_FIXED = [
            { name: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', value68: 11048897, value69: 2716175, weight: 44.67, target6m: 6531542, target10m: 9605208, target12m: 12678875 },
            { name: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', value68: 2204389, value69: 1407538, weight: 17.22, target6m: 2517563, target10m: 3702299, target12m: 4887035 },
            { name: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', value68: 4731862, value69: 588540, weight: 13.62, target6m: 1990947, target10m: 2927863, target12m: 3864780 },
            { name: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', value68: 3421324, value69: 808581, weight: 13.52, target6m: 1976928, target10m: 2907247, target12m: 3837566 },
            { name: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', value68: 1595167, value69: 324989, weight: 5.81, target6m: 848766, target10m: 1248185, target12m: 1647604 },
            { name: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', value68: 747135, value69: 406968, weight: 5.16, target6m: 754946, target10m: 1110215, target12m: 1465484 }
        ];

        const PROVINCIAL_TARGETS = {
            month6: 14620693.83,
            month10: 21501020.34,
            month12: 28381346.85
        };

        const INITIAL_UNIT_DATA_FROM_CSV = [
            // ‡πÄ‡∏°‡∏∑‡∏≠‡∏á (21 ‡πÅ‡∏´‡πà‡∏á)
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00933', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏™‡∏≥‡πÇ‡∏£‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠', value68: 254592.00, value69: 102673, weight: 0.98951136, target6m: 145615.39, percent6m: 70.51 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00934', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á', value68: 104770.55, value69: 55117, weight: 0.70545194, target6m: 102976.31, percent6m: 53.52 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00935', name: '‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢‡∏Ø ‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡∏•‡∏≠‡∏á‡∏ö‡∏≤‡∏á‡∏õ‡∏¥‡πâ‡∏á', value68: 252527.70, value69: 215556, weight: 2.49398708, target6m: 364052.58, percent6m: 59.21 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00936', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏õ‡∏π‡πÉ‡∏´‡∏°‡πà', value68: 124731.90, value69: 89242, weight: 1.06654564, target6m: 155685.93, percent6m: 57.32 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00937', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÅ‡∏û‡∏£‡∏Å‡∏©‡∏≤', value68: 301505.50, value69: 97827, weight: 1.44683313, target6m: 211197.30, percent6m: 46.32 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00938', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡∏á', value68: 67047.00, value69: 52643, weight: 0.61817478, target6m: 90236.42, percent6m: 58.34 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00939', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏õ‡∏π', value68: 83277.00, value69: 77629, weight: 0.88510842, target6m: 129199.98, percent6m: 60.08 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00940', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏ô', value68: 49057.25, value69: 16468, weight: 0.24067332, target6m: 35131.63, percent6m: 46.88 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00941', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà', value68: 349113.75, value69: 38342, weight: 0.95583727, target6m: 139534.69, percent6m: 27.48 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00942', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏ó‡∏û‡∏≤‡∏£‡∏±‡∏Å‡∏©‡πå', value68: 404607.00, value69: 138493, weight: 2.01053073, target6m: 293481.54, percent6m: 47.19 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00943', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ó‡πâ‡∏≤‡∏¢‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà', value68: 527295.75, value69: 97898, weight: 1.82729302, target6m: 266734.02, percent6m: 36.70 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00944', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÅ‡∏û‡∏£‡∏Å‡∏©‡∏≤‡πÉ‡∏´‡∏°‡πà', value68: 295065.50, value69: 125628, weight: 1.70258763, target6m: 248528.09, percent6m: 50.55 },
            // UPDATED RECORD: 10685 ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '10685', name: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', value68: 7458558.50, value69: 1274278, weight: 24.80, target6m: 3619659, percent6m: 35.20 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '13812', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ó‡πâ‡∏≤‡∏¢‡∏ö‡πâ‡∏≤‡∏ô', value68: 73916.20, value69: 51252, weight: 0.61633440, target6m: 89967.77, percent6m: 56.97 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '15048', name: '‡∏®‡∏™‡∏ä. ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', value68: 28783.50, value69: 13022, weight: 0.17343135, target6m: 25316.20, percent6m: 51.44 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '23945', name: '‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢‡∏Ø ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏±‡∏î‡∏ö‡∏≤‡∏á‡∏õ‡∏¥‡πâ‡∏á', value68: 109445.25, value69: 11842, weight: 0.29797370, target6m: 43496.86, percent6m: 27.22 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '24027', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏û‡∏∏‡∏ó‡∏ò‡∏£‡∏±‡∏Å‡∏©‡∏≤', value68: 117408.50, value69: 83418, weight: 0.99805540, target6m: 146862.58, percent6m: 56.80 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '24028', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏£‡πà‡∏°‡πÇ‡∏û‡∏ò‡∏¥‡πå', value68: 109259.00, value69: 21237, weight: 0.38780775, target6m: 56610.15, percent6m: 37.51 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '24029', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏∏‡∏ç‡∏®‡∏¥‡∏£‡∏¥', value68: 22214.90, value69: 13881, weight: 0.17059737, target6m: 24902.51, percent6m: 55.74 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '24702', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ï‡∏≥‡∏ö‡∏•‡∏™‡∏≥‡πÇ‡∏£‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠', value68: 48189.25, value69: 30678, weight: 0.37554900, target6m: 54820.72, percent6m: 55.96 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '28826', name: '‡∏£‡∏û.‡∏™‡∏ï.‡∏°‡∏±‡∏á‡∏Å‡∏£‡∏ó‡∏≠‡∏á', value68: 254058.75, value69: 81949, weight: 1.21415275, target6m: 177232.42, percent6m: 46.24 },

            // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á (17 ‡πÅ‡∏´‡πà‡∏á)
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00964', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏û‡∏∂‡πà‡∏á', value68: 95085.50, value69: 9807, weight: 0.25424720, target6m: 37113.04, percent6m: 26.42 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00965', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏à‡∏≤‡∏Å', value68: 28794.50, value69: 36195, weight: 0.39575842, target6m: 57770.73, percent6m: 62.65 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00966', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏∏', value68: 91257.80, value69: 66600, weight: 0.79282362, target6m: 115729.04, percent6m: 57.55 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00967', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÅ‡∏û‡∏£‡∏Å', value68: 112270.30, value69: 66820, weight: 0.83032745, target6m: 121203.54, percent6m: 55.13 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00968', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏™‡∏∑‡∏≠', value68: 23558.00, value69: 471540, weight: 4.56447788, target6m: 666324.96, percent6m: 70.77 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00969', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏¢‡∏≠', value68: 182484.75, value69: 47126, weight: 0.75960447, target6m: 110880.00, percent6m: 42.50 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00970', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏Å‡∏∞‡πÄ‡∏à‡πâ‡∏≤', value68: 50806.50, value69: 36016, weight: 0.43114389, target6m: 62936.01, percent6m: 57.23 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00971', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', value68: 32691.50, value69: 26325, weight: 0.30765275, target6m: 44909.73, percent6m: 58.62 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00972', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö', value68: 58464.98, value69: 25103, weight: 0.33932225, target6m: 49532.58, percent6m: 50.68 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00973', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏Å‡∏≠‡∏ö‡∏±‡∏ß', value68: 73088.00, value69: 28990, weight: 0.40127272, target6m: 58575.66, percent6m: 49.49 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00974', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏Å‡∏≠', value68: 22902.00, value69: 10310, weight: 0.13750275, target6m: 20071.51, percent6m: 51.37 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00975', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ó‡∏£‡∏á‡∏Ñ‡∏ô‡∏≠‡∏á', value68: 169940.00, value69: 45156, weight: 0.71957900, target6m: 105037.42, percent6m: 42.99 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00976', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏™‡∏≥‡πÇ‡∏£‡∏á', value68: 41136.80, value69: 52064, weight: 0.56897262, target6m: 83054.34, percent6m: 62.69 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00977', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏™‡∏≥‡πÇ‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á', value68: 44034.00, value69: 58837, weight: 0.63878772, target6m: 93245.33, percent6m: 63.10 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00978', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏™‡∏≥‡πÇ‡∏£‡∏á‡πÉ‡∏ï‡πâ', value68: 58911.00, value69: 32116, weight: 0.40742299, target6m: 59473.43, percent6m: 54.00 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '10754', name: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ö‡∏≤‡∏á‡∏à‡∏≤‡∏Å', value68: 1079436.34, value69: 336896, weight: 5.05117498, target6m: 737368.99, percent6m: 45.69 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '23944', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏à‡∏£‡∏¥‡∏ç', value68: 39527.20, value69: 33168, weight: 0.38487739, target6m: 56182.40, percent6m: 59.04 },

            // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠ (15 ‡πÅ‡∏´‡πà‡∏á)
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00945', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', value68: 121492.25, value69: 43367, weight: 0.62071987, target6m: 90607.93, percent6m: 47.86 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00946', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏£‡∏∞‡∏Å‡∏≤‡∏® ‡∏´‡∏°‡∏π‡πà 3', value68: 132302.00, value69: 22816, weight: 0.44173295, target6m: 64481.72, percent6m: 35.38 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00947', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏£‡∏∞‡∏Å‡∏≤‡∏® ‡∏´‡∏°‡∏π‡πà 8', value68: 408396.50, value69: 68398, weight: 1.34415840, target6m: 196210.89, percent6m: 34.86 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00948', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ‡∏ô‡πâ‡∏≠‡∏¢ ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà 3', value68: 219134.50, value69: 83925, weight: 1.17430932, target6m: 171416.42, percent6m: 48.96 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00949', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ‡∏ô‡πâ‡∏≠‡∏¢ ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà 5', value68: 84529.58, value69: 28805, weight: 0.41879940, target6m: 61134.07, percent6m: 47.12 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00950', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ‡∏ô‡πâ‡∏≠‡∏¢ ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà 8', value68: 59245.73, value69: 18381, weight: 0.27613727, target6m: 40308.83, percent6m: 45.60 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00951', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÄ‡∏û‡∏£‡∏µ‡∏¢‡∏á', value68: 245369.18, value69: 71167, weight: 1.09619623, target6m: 160014.12, percent6m: 44.48 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00952', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏î‡πà‡∏≤‡∏ô ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà 1', value68: 306666.63, value69: 55016, weight: 1.04439395, target6m: 152452.41, percent6m: 36.09 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00953', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏î‡πà‡∏≤‡∏ô ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà 13', value68: 126797.50, value69: 50152, weight: 0.69476023, target6m: 101415.63, percent6m: 49.45 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00954', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏™‡∏ß‡∏ô', value68: 96457.25, value69: 54967, weight: 0.68984920, target6m: 100698.76, percent6m: 54.59 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00955', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏õ‡∏£‡πá‡∏á', value68: 127617.50, value69: 58488, weight: 0.77609205, target6m: 113286.70, percent6m: 51.63 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00956', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ô‡∏¥‡∏¢‡∏°‡∏¢‡∏≤‡∏ï‡∏£‡∏≤', value68: 155008.07, value69: 58253, weight: 0.81997380, target6m: 119692.19, percent6m: 48.67 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '10752', name: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', value68: 1155310.40, value69: 92990.5, weight: 2.83789973, target6m: 414253.94, percent6m: 22.45 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '23032', name: '‡∏®‡∏™‡∏ä.‡∏£‡∏û.‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', value68: 20467.75, value69: 20536, weight: 0.23147817, target6m: 33789.40, percent6m: 60.78 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '23911', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏î‡πà‡∏≤‡∏ô ‡∏´‡∏°‡∏π‡πà 7', value68: 162529.50, value69: 25008, weight: 0.51374747, target6m: 74992.83, percent6m: 33.35 },

            // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ (11 ‡πÅ‡∏´‡πà‡∏á)
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00957', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡∏ß', value68: 302124.00, value69: 91943, weight: 1.39097782, target6m: 203045.15, percent6m: 45.28 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00958', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ß‡∏±‡∏î‡∏™‡∏•‡∏∏‡∏î', value68: 32770.75, value69: 18350, weight: 0.23126767, target6m: 33758.67, percent6m: 54.36 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00959', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏õ‡∏•‡∏≤', value68: 24395.40, value69: 17793, weight: 0.21181282, target6m: 30918.79, percent6m: 57.55 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00960', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏™‡∏µ‡πà', value68: 43534.00, value69: 12912, weight: 0.19719875, target6m: 28785.55, percent6m: 44.86 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00961', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÇ‡∏â‡∏•‡∏á', value68: 67576.50, value69: 56618, weight: 0.65706788, target6m: 95913.72, percent6m: 59.03 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00962', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏ó‡∏ß‡∏∞', value68: 92726.50, value69: 49278, weight: 0.62900768, target6m: 91817.72, percent6m: 53.67 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00963', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏´‡∏ô‡∏≠‡∏á‡∏õ‡∏£‡∏∑‡∏≠', value68: 32248.00, value69: 20982, weight: 0.25564996, target6m: 37317.80, percent6m: 56.22 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '10753', name: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', value68: 4085592.75, value69: 298363, weight: 9.74313527, target6m: 1422227.05, percent6m: 20.98 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '23034', name: '‡∏®‡∏û‡∏ä.‡∏ß‡∏±‡∏î‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ‡πÉ‡∏´‡∏ç‡πà‡∏Å‡∏•‡∏≤‡∏á', value68: 6799.75, value69: 13883, weight: 0.14464150, target6m: 21113.57, percent6m: 65.75 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '24675', name: '‡∏£‡∏û.‡∏™‡∏ï.‡∏ö‡∏±‡∏ß‡πÄ‡∏Å‡∏£‡∏≤‡∏∞', value68: 44095.15, value69: 9566, weight: 0.16604169, target6m: 24237.50, percent6m: 39.47 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '99826', name: '‡∏®‡∏™‡∏ä.1 ‡∏£‡∏û.‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', value68: 0.00, value69: 0, weight: 0.00000000, target6m: 0.00, percent6m: 0.00 },

            // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå (11 ‡πÅ‡∏´‡πà‡∏á)
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00979', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏∏‡∏ô‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÑ‡∏ó‡∏¢', value68: 21079.00, value69: 1323, weight: 0.04820294, target6m: 7036.30, percent6m: 18.80 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00980', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ô‡∏≤‡πÄ‡∏Å‡∏•‡∏∑‡∏≠', value68: 179216.89, value69: 19553, weight: 0.48943809, target6m: 71444.34, percent6m: 27.37 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00981', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡∏•‡∏≠‡∏á‡∏ó‡∏∞‡πÄ‡∏•', value68: 56166.20, value69: 14267, weight: 0.23149443, target6m: 33791.78, percent6m: 42.22 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00982', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡∏•‡∏≠‡∏á‡∏™‡∏ß‡∏ô', value68: 100264.92, value69: 14156, weight: 0.30468984, target6m: 44477.22, percent6m: 31.83 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00983', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÅ‡∏´‡∏•‡∏°‡∏ü‡πâ‡∏≤‡∏ú‡πà‡∏≤', value68: 220384.50, value69: 45507, weight: 0.80786377, target6m: 117924.49, percent6m: 38.59 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00984', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏∏‡∏ô‡∏™‡∏°‡∏∏‡∏ó‡∏£', value68: 15070.60, value69: 3584, weight: 0.05976527, target6m: 8724.08, percent6m: 41.08 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00985', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÉ‡∏ô‡∏Ñ‡∏•‡∏≠‡∏á‡∏ö‡∏≤‡∏á‡∏õ‡∏•‡∏≤‡∏Å‡∏î', value68: 196258.87, value69: 78281, weight: 1.08157774, target6m: 157880.22, percent6m: 49.58 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00986', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡∏π‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á', value68: 333751.99, value69: 47722, weight: 1.02009228, target6m: 148906.40, percent6m: 32.05 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '10755', name: '‡∏£‡∏û.‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå‡∏™‡∏ß‡∏≤‡∏ó‡∏¢‡∏≤‡∏ô‡∏ô‡∏ó‡πå', value68: 262004.25, value69: 61770, weight: 1.03399064, target6m: 150935.18, percent6m: 40.92 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '24410', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡∏•‡∏≠‡∏á‡∏ô‡∏≤‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢', value68: 136754.84, value69: 26281, weight: 0.48253066, target6m: 70436.06, percent6m: 37.31 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '24559', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡∏≠‡∏≠‡∏°', value68: 74215.50, value69: 25227, weight: 0.36706788, target6m: 53582.71, percent6m: 47.08 },

            // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á (9 ‡πÅ‡∏´‡πà‡∏á)
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00987', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', value68: 105548.00, value69: 40218, weight: 0.56372074, target6m: 82287.71, percent6m: 48.87 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00988', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏™‡∏≤‡∏ò‡∏á‡∏Å‡∏•‡∏≤‡∏á', value68: 55667.00, value69: 31051, weight: 0.39174697, target6m: 57185.16, percent6m: 54.30 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00989', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', value68: 0.00, value69: 0, weight: 0.00000000, target6m: 0.00, percent6m: 0.00 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00990', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏®‡∏£‡∏µ‡∏©‡∏∞‡∏à‡∏£‡∏∞‡πÄ‡∏Ç‡πâ‡∏ô‡πâ‡∏≠‡∏¢', value68: 58904.25, value69: 39501, weight: 0.47830892, target6m: 69819.77, percent6m: 56.58 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00991', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏®‡∏µ‡∏£‡∏©‡∏∞‡∏à‡∏£‡πÄ‡∏Ç‡πâ‡πÉ‡∏´‡∏ç‡πà', value68: 21625.75, value69: 6636, weight: 0.10012203, target6m: 14615.03, percent6m: 45.41 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00992', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏ß‡∏≤‡∏£‡∏µ‡∏ô‡πâ‡∏≠‡∏¢', value68: 158459.00, value69: 187721, weight: 2.06822294, target6m: 301902.99, percent6m: 62.18 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '24411', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå', value68: 84071.82, value69: 54524, weight: 0.66487962, target6m: 97053.99, percent6m: 56.18 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '24412', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Å‡∏±‡∏•‡∏õ‡∏û‡∏§‡∏Å‡∏©‡πå', value68: 28910.00, value69: 22492, weight: 0.26453963, target6m: 38615.45, percent6m: 58.25 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '28785', name: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', value68: 233949.25, value69: 35378, weight: 0.73359676, target6m: 107083.63, percent6m: 33.04 }
        ];

        // --- Helpers ---
        const formatCurrency = (val) => new Intl.NumberFormat('th-TH', { style: 'currency', currency: 'THB', minimumFractionDigits: 2 }).format(val);
        const formatNumber = (val) => new Intl.NumberFormat('th-TH').format(val);

        // --- Components ---
        const Card = ({ children, className = "" }) => (
            <div className={`bg-white rounded-xl shadow-sm border border-sky-100 p-6 ${className}`}>
                {children}
            </div>
        );

        const KPICard = ({ title, value, subtext, icon: Icon, colorClass }) => (
            <Card className="relative overflow-hidden hover:shadow-md transition-shadow">
                <div className="flex justify-between items-start">
                    <div>
                        <p className="text-slate-500 text-sm font-medium mb-1">{title}</p>
                        <h3 className="text-2xl font-bold text-slate-800">{value}</h3>
                        {subtext && <p className="text-xs text-slate-400 mt-2">{subtext}</p>}
                    </div>
                    <div className={`p-3 rounded-lg ${colorClass} bg-opacity-10`}>
                        <Icon />
                    </div>
                </div>
            </Card>
        );

        // --- Main App Logic ---
        function App() {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [isSidebarOpen, setIsSidebarOpen] = useState(true);
            const [lastUpdated] = useState(new Date().toLocaleDateString('th-TH'));

            // 1. Process District Data (Use FIXED DATA directly to match Excel exactly)
            const processedDistrictData = useMemo(() => {
                return PROVINCIAL_DATA_FIXED.sort((a,b) => b.weight - a.weight);
            }, []);

            // 2. Use Unit Data from CSV directly
            const processedUnitData = useMemo(() => {
                return INITIAL_UNIT_DATA_FROM_CSV.map(u => ({
                    ...u,
                    target12m: u.weight * PROVINCIAL_TARGETS.month12, 
                    percentAchieved6m: u.percent6m 
                }));
            }, []);

            // Group Units by District
            const groupedUnits = useMemo(() => {
                return _.groupBy(processedUnitData, 'district');
            }, [processedUnitData]);

            // Views
            const DashboardView = () => {
                const totalUsage = processedDistrictData.reduce((acc, cur) => acc + cur.value69, 0);
                const progress = (totalUsage / PROVINCIAL_TARGETS.month6) * 100;

                return (
                    <div className="space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500">
                         <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            <KPICard title="‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏õ‡∏µ 2569 (‡∏™‡∏∞‡∏™‡∏°)" value={formatCurrency(totalUsage)} subtext={`‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${lastUpdated}`} icon={ICONS.TrendingUp} colorClass="text-blue-600 bg-blue-600" />
                            <KPICard title="‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)" value={formatCurrency(PROVINCIAL_TARGETS.month6)} subtext="‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 2569" icon={ICONS.Map} colorClass="text-sky-600 bg-sky-600" />
                            <KPICard title="‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏õ‡πâ‡∏≤ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô" value={`${progress.toFixed(2)}%`} subtext="‡∏Ç‡∏≠‡∏á‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î" icon={progress >= 50 ? ICONS.CheckCircle : ICONS.AlertCircle} colorClass={progress >= 50 ? "text-emerald-500 bg-emerald-500" : "text-amber-500 bg-amber-500"} />
                            <KPICard title="‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏£‡∏ß‡∏° (12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)" value={formatCurrency(PROVINCIAL_TARGETS.month12)} subtext="‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ" icon={ICONS.Calculator} colorClass="text-indigo-600 bg-indigo-600" />
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                             <Card>
                                <h3 className="text-lg font-bold text-slate-800 mb-6">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (%)</h3>
                                <div className="h-72">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <PieChart>
                                            <Pie data={processedDistrictData} cx="50%" cy="50%" innerRadius={60} outerRadius={90} paddingAngle={5} dataKey="target12m">
                                                {processedDistrictData.map((entry, index) => (
                                                    <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                                                ))}
                                            </Pie>
                                            <RechartsTooltip formatter={(value) => formatCurrency(value)} />
                                            <Legend />
                                        </PieChart>
                                    </ResponsiveContainer>
                                </div>
                            </Card>
                            <Card>
                                <h3 className="text-lg font-bold text-slate-800 mb-6">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á vs ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠)</h3>
                                <div className="h-72">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <ComposedChart data={processedDistrictData} margin={{top:20, right:20, bottom:20, left:20}}>
                                            <CartesianGrid stroke="#f5f5f5" strokeDasharray="3 3" vertical={false}/>
                                            <XAxis dataKey="name" fontSize={12} scale="point" padding={{left:10, right:10}} />
                                            <YAxis fontSize={12} tickFormatter={(val)=>`${(val/1000000).toFixed(1)}M`} />
                                            <RechartsTooltip formatter={(value) => formatCurrency(value)} />
                                            <Legend />
                                            <Bar dataKey="value69" name="‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á 69" barSize={20} fill="#0EA5E9" radius={[4,4,0,0]} />
                                            <Line type="monotone" dataKey="target6m" name="‡πÄ‡∏õ‡πâ‡∏≤ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô" stroke="#EF4444" strokeWidth={2} dot={{r:4}} />
                                        </ComposedChart>
                                    </ResponsiveContainer>
                                </div>
                            </Card>
                        </div>

                        {/* Detailed Analysis Section */}
                        <Card className="bg-gradient-to-br from-white to-blue-50 border-blue-200">
                            <h3 className="text-xl font-bold text-blue-800 mb-4 flex items-center gap-2">
                                <ICONS.Search /> ‡∏ö‡∏ó‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å (Comprehensive Analysis)
                            </h3>
                            <div className="space-y-4 text-slate-700 leading-relaxed">
                                <p>
                                    <strong className="text-blue-700">1. ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£:</strong> 
                                    ‡∏¢‡∏≠‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏™‡∏∞‡∏™‡∏° (YTD) ‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà <span className="font-bold text-slate-900">{formatCurrency(totalUsage)}</span> 
                                    ‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô <span className={`font-bold ${progress >= 33 ? 'text-green-600' : 'text-amber-600'}`}>{progress.toFixed(2)}%</span> ‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏£‡∏Å 
                                    (Benchmark ‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏∑‡∏≠ ~33% ‡∏ì ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2 ‡∏Ç‡∏≠‡∏á‡∏á‡∏ß‡∏î 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4 ‡∏Ç‡∏≠‡∏á‡∏õ‡∏µ‡∏á‡∏ö‡∏Ø) 
                                    ‡∏ã‡∏∂‡πà‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î <span className="font-bold">{progress >= 33 ? '‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏ö‡∏£‡∏£‡∏•‡∏∏‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏î‡∏µ (On Track)' : '‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡πà‡∏á‡∏£‡∏±‡∏î‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (Need Improvement)'}</span>
                                </p>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
                                    <div className="bg-white p-4 rounded-lg border border-blue-100 shadow-sm">
                                        <h4 className="font-bold text-emerald-600 mb-2">üåü ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á (Top Performers)</h4>
                                        <ul className="list-disc list-inside text-sm space-y-1">
                                            <li><strong>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á:</strong> ‡∏°‡∏µ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏≤‡∏Å ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏õ‡πâ‡∏≤ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏™‡∏π‡∏á‡∏ñ‡∏∂‡∏á <span className="font-bold">{(processedDistrictData.find(d => d.name === '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á').value69 / processedDistrictData.find(d => d.name === '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á').target6m * 100).toFixed(1)}%</span> ‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</li>
                                            <li><strong>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á:</strong> ‡∏°‡∏µ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÄ‡∏£‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ (‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô {(processedDistrictData.find(d => d.name === '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á').value69 / processedDistrictData.find(d => d.name === '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á').target6m * 100).toFixed(1)}%) ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡∏£‡∏û.‡∏™‡∏ï.‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏ß‡∏≤‡∏£‡∏µ‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡∏™‡∏π‡∏á</li>
                                        </ul>
                                    </div>
                                    <div className="bg-white p-4 rounded-lg border border-red-100 shadow-sm">
                                        <h4 className="font-bold text-amber-600 mb-2">‚ö†Ô∏è ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° (Monitoring Required)</h4>
                                        <ul className="list-disc list-inside text-sm space-y-1">
                                            <li><strong>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ:</strong> ‡πÅ‡∏°‡πâ‡∏à‡∏∞‡∏°‡∏µ‡∏ê‡∏≤‡∏ô‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏™‡∏π‡∏á (13.62%) ‡πÅ‡∏ï‡πà‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà <span className="font-bold">{(processedDistrictData.find(d => d.name === '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ').value69 / processedDistrictData.find(d => d.name === '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ').target6m * 100).toFixed(1)}%</span> ‡∏ã‡∏∂‡πà‡∏á‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô</li>
                                            <li><strong>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á:</strong> ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (Weight 44.67%) ‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡∏ó‡∏≥‡πÑ‡∏î‡πâ {(processedDistrictData.find(d => d.name === '‡πÄ‡∏°‡∏∑‡∏≠‡∏á').value69 / processedDistrictData.find(d => d.name === '‡πÄ‡∏°‡∏∑‡∏≠‡∏á').target6m * 100).toFixed(1)}% ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ú‡∏•‡∏±‡∏Å‡∏î‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å</li>
                                        </ul>
                                    </div>
                                </div>

                                <p className="text-sm bg-blue-100 p-3 rounded-md text-blue-800 border-l-4 border-blue-500">
                                    <strong>‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå:</strong> ‡∏Ñ‡∏ß‡∏£‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏£‡∏∏‡∏Å‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏¥‡πÄ‡∏ó‡∏®‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ö‡∏£‡∏£‡∏•‡∏∏‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ 28.3 ‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó ‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
                                </p>
                            </div>
                        </Card>
                    </div>
                );
            };

            const DistrictView = () => {
                const totalRow = useMemo(() => {
                    return processedDistrictData.reduce((acc, curr) => {
                        return {
                            value68: acc.value68 + curr.value68,
                            value69: acc.value69 + curr.value69,
                            weight: acc.weight + curr.weight,
                            target6m: acc.target6m + curr.target6m,
                            target12m: acc.target12m + curr.target12m
                        };
                    }, { value68: 0, value69: 0, weight: 0, target6m: 0, target12m: 0 });
                }, [processedDistrictData]);

                // Calculate achievement % for summary
                const summaryAchieved6m = totalRow.target6m > 0 ? (totalRow.value69 / totalRow.target6m * 100) : 0;

                // --- NEW ANALYSIS FUNCTION FOR MENU 2 ---
                const analyzeDistrictPerformance = (data) => {
                    const sorted = [...data].map(d => ({
                        ...d,
                        percent: (d.value69 / d.target6m) * 100
                    })).sort((a,b) => b.percent - a.percent);

                    const stars = sorted.filter(d => d.percent >= 50);
                    const cashCows = sorted.filter(d => d.percent >= 35 && d.percent < 50);
                    const questionMarks = sorted.filter(d => d.percent < 35);

                    return { stars, cashCows, questionMarks };
                };

                const analysis = analyzeDistrictPerformance(processedDistrictData);

                return (
                    <div className="animate-in fade-in slide-in-from-bottom-4 duration-500 space-y-6">
                        <Card className="overflow-hidden">
                            <div className="flex justify-between items-center mb-6">
                                <h3 className="text-lg font-bold text-slate-800">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ï‡∏≤‡∏° Excel)</h3>
                                <button className="flex items-center gap-2 text-sm text-blue-600 font-bold hover:bg-blue-50 px-3 py-2 rounded-lg transition-colors">
                                    <ICONS.Download /> Export CSV
                                </button>
                            </div>
                            <div className="overflow-x-auto">
                                <table className="w-full text-sm text-left text-slate-600">
                                    <thead className="text-xs text-slate-700 uppercase bg-sky-50 border-b border-sky-200">
                                        <tr>
                                            <th className="px-6 py-4 font-bold text-sky-900">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</th>
                                            <th className="px-6 py-4 text-right">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏µ 68</th>
                                            <th className="px-6 py-4 text-right">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏µ 69</th>
                                            <th className="px-6 py-4 text-center">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏£‡∏ß‡∏° (%)</th>
                                            <th className="px-6 py-4 text-right bg-sky-100 text-sky-900 font-bold border-l border-r border-sky-200">‡πÄ‡∏õ‡πâ‡∏≤ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
                                            <th className="px-6 py-4 text-center font-bold text-emerald-700">‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô % ‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤ 6‡∏î.</th> 
                                            <th className="px-6 py-4 text-right">‡πÄ‡∏õ‡πâ‡∏≤ 12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {processedDistrictData.map((item, index) => {
                                            const percentAchieved = (item.value69 / item.target6m) * 100; // Calculation
                                            return (
                                                <tr key={index} className="bg-white border-b hover:bg-sky-50 transition-colors">
                                                    <td className="px-6 py-4 font-medium text-slate-900">{item.name}</td>
                                                    <td className="px-6 py-4 text-right font-mono">{formatNumber(item.value68)}</td>
                                                    <td className="px-6 py-4 text-right font-mono text-blue-600 font-bold">{formatNumber(item.value69)}</td>
                                                    <td className="px-6 py-4 text-center">
                                                        <span className="bg-slate-100 text-slate-800 py-1 px-3 rounded-full text-xs font-bold shadow-sm">
                                                            {item.weight.toFixed(2)}%
                                                        </span>
                                                    </td>
                                                    <td className="px-6 py-4 text-right font-bold text-blue-700 bg-sky-50 border-l border-r border-sky-100">{formatCurrency(item.target6m)}</td>
                                                    <td className="px-6 py-4 text-center">
                                                        <span className={`px-2 py-1 rounded text-xs font-bold ${percentAchieved >= 33 ? 'bg-emerald-100 text-emerald-700' : 'bg-orange-100 text-orange-700'}`}>
                                                            {percentAchieved.toFixed(2)}%
                                                        </span>
                                                    </td>
                                                    <td className="px-6 py-4 text-right">{formatCurrency(item.target12m)}</td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                    <tfoot className="bg-sky-100 font-bold text-sky-900 border-t-2 border-sky-300">
                                        <tr>
                                            <td className="px-6 py-4 text-right">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</td>
                                            <td className="px-6 py-4 text-right">{formatNumber(totalRow.value68)}</td>
                                            <td className="px-6 py-4 text-right">{formatNumber(totalRow.value69)}</td>
                                            <td className="px-6 py-4 text-center">{Math.round(totalRow.weight)}%</td>
                                            <td className="px-6 py-4 text-right border-l border-r border-sky-300">{formatCurrency(totalRow.target6m)}</td>
                                            <td className="px-6 py-4 text-center text-emerald-800">{summaryAchieved6m.toFixed(2)}%</td>
                                            <td className="px-6 py-4 text-right">{formatCurrency(totalRow.target12m)}</td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </Card>

                        {/* --- NEW STRATEGIC ANALYSIS SECTION (Menu 2) --- */}
                        <Card className="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200">
                            <h3 className="text-xl font-bold text-indigo-900 mb-6 flex items-center gap-2">
                                <ICONS.Award /> ‡∏ö‡∏ó‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå (Strategic Analysis & Recommendations)
                            </h3>
                            
                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                                {/* Stars */}
                                <div className="bg-white p-5 rounded-xl border-l-4 border-l-emerald-500 shadow-sm">
                                    <h4 className="font-bold text-emerald-700 mb-3 flex items-center gap-2">
                                        <div className="w-2 h-2 rounded-full bg-emerald-500"></div> ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥ (Stars)
                                        <span className="text-xs bg-emerald-100 px-2 py-0.5 rounded text-emerald-800">&gt; 50%</span>
                                    </h4>
                                    <p className="text-sm text-slate-600 mb-2">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏î‡πÄ‡∏î‡πà‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏£‡∏∞‡∏¢‡∏∞‡∏™‡∏±‡πâ‡∏ô</p>
                                    <ul className="list-disc list-inside text-sm font-semibold text-slate-800">
                                        {analysis.stars.map(d => (
                                            <li key={d.name}>{d.name} ({d.percent.toFixed(1)}%)</li>
                                        ))}
                                    </ul>
                                    <div className="mt-3 pt-3 border-t border-slate-100 text-xs text-slate-500">
                                        <strong>‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞:</strong> ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏ñ‡∏≠‡∏î‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (Best Practice) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏≠‡∏∑‡πà‡∏ô ‡πÅ‡∏•‡∏∞‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Ç‡∏¢‡∏±‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢ (Stretch Goal)
                                    </div>
                                </div>

                                {/* Cash Cows */}
                                <div className="bg-white p-5 rounded-xl border-l-4 border-l-blue-500 shadow-sm">
                                    <h4 className="font-bold text-blue-700 mb-3 flex items-center gap-2">
                                        <div className="w-2 h-2 rounded-full bg-blue-500"></div> ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û (Cash Cows)
                                        <span className="text-xs bg-blue-100 px-2 py-0.5 rounded text-blue-800">35-50%</span>
                                    </h4>
                                    <p className="text-sm text-slate-600 mb-2">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ ‡∏°‡∏µ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡∏†‡∏≤‡∏û</p>
                                    <ul className="list-disc list-inside text-sm font-semibold text-slate-800">
                                        {analysis.cashCows.map(d => (
                                            <li key={d.name}>{d.name} ({d.percent.toFixed(1)}%)</li>
                                        ))}
                                    </ul>
                                    <div className="mt-3 pt-3 border-t border-slate-100 text-xs text-slate-500">
                                        <strong>‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞:</strong> ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏à‡∏∏‡∏î‡∏™‡∏∞‡∏î‡∏∏‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ú‡∏•‡∏±‡∏Å‡∏î‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏π‡πà‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥ ‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏£‡∏∏‡∏Å
                                    </div>
                                </div>

                                {/* Question Marks */}
                                <div className="bg-white p-5 rounded-xl border-l-4 border-l-orange-500 shadow-sm">
                                    <h4 className="font-bold text-orange-700 mb-3 flex items-center gap-2">
                                        <div className="w-2 h-2 rounded-full bg-orange-500"></div> ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á (Question Marks)
                                        <span className="text-xs bg-orange-100 px-2 py-0.5 rounded text-orange-800">&lt; 35%</span>
                                    </h4>
                                    <p className="text-sm text-slate-600 mb-2">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡πà‡∏á‡∏£‡∏±‡∏î</p>
                                    <ul className="list-disc list-inside text-sm font-semibold text-slate-800">
                                        {analysis.questionMarks.map(d => (
                                            <li key={d.name}>{d.name} ({d.percent.toFixed(1)}%)</li>
                                        ))}
                                    </ul>
                                    <div className="mt-3 pt-3 border-t border-slate-100 text-xs text-slate-500">
                                        <strong>‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞:</strong> ‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏¥‡πÄ‡∏ó‡∏®‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (Root Cause Analysis) ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÅ‡∏ú‡∏ô‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π‡∏ú‡∏•‡∏á‡∏≤‡∏ô (Recovery Plan) ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                                    </div>
                                </div>
                            </div>

                            <div className="bg-white p-4 rounded-lg border border-indigo-100 text-sm text-slate-700 leading-relaxed">
                                <strong className="text-indigo-800 block mb-1">üí° ‡∏ö‡∏ó‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ (Executive Summary):</strong>
                                ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà <span className="font-bold">{summaryAchieved6m.toFixed(2)}%</span> ‡∏ã‡∏∂‡πà‡∏á‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤ <span className="text-emerald-600 font-bold">‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏£‡∏∞‡∏¢‡∏∞ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (On Track)</span> ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏° ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏∑‡πà‡∏≠‡∏°‡∏•‡πâ‡∏≥‡∏Ç‡∏≠‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (Gap) ‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏™‡∏π‡∏á ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞ <strong>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ</strong> ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏ï‡πà‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏¢‡∏±‡∏á‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏´‡∏≤‡∏Å‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ‡πÉ‡∏´‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö 35% ‡πÑ‡∏î‡πâ ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏∞‡∏•‡∏∏‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á
                            </div>
                        </Card>
                    </div>
                );
            };

            const UnitView = () => {
                const [selectedDistrict, setSelectedDistrict] = useState('All');
                const printRef = useRef();

                // Export to PDF function
                const handleExportPDF = () => {
                    const element = printRef.current;
                    if (!element) return;

                    // Temporary style for printing
                    const originalStyle = element.style.cssText;
                    element.classList.add('print-mode');

                    const opt = {
                        margin: [10, 10, 10, 10], // top, left, bottom, right in mm
                        filename: `Herbal_Report_${selectedDistrict}_${new Date().toISOString().split('T')[0]}.pdf`,
                        image: { type: 'jpeg', quality: 0.98 },
                        html2canvas: { scale: 2, useCORS: true },
                        jsPDF: { unit: 'mm', format: 'a4', orientation: 'landscape' } // Landscape for wide tables
                    };

                    // Use html2pdf to generate PDF
                    html2pdf().set(opt).from(element).save().then(() => {
                         element.classList.remove('print-mode');
                    });
                };
                
                // Helper component for District Analysis Box
                const DistrictAnalysisBox = ({ units, districtName }) => {
                    const sortedUnits = [...units].sort((a, b) => b.percentAchieved6m - a.percentAchieved6m);
                    const topUnit = sortedUnits[0];
                    const bottomUnit = sortedUnits.filter(u => u.target6m > 0).pop(); 
                    const avgProgress = units.reduce((acc, u) => acc + u.percentAchieved6m, 0) / units.length;
                    
                    return (
                        <div className="mt-4 bg-sky-50 p-4 rounded-lg border border-sky-200 break-inside-avoid">
                            <h4 className="font-bold text-blue-800 flex items-center gap-2 mb-3">
                                <ICONS.Lightbulb /> ‡∏ö‡∏ó‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞: ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠{districtName}
                            </h4>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                <div>
                                    <p className="mb-2"><span className="font-semibold text-emerald-600">üèÜ ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏î‡∏µ‡πÄ‡∏î‡πà‡∏ô:</span> {topUnit?.name} (‡∏ó‡∏≥‡πÑ‡∏î‡πâ {topUnit?.percentAchieved6m.toFixed(1)}% ‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤)</p>
                                    <p><span className="font-semibold text-red-500">‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡πà‡∏á‡∏£‡∏±‡∏î:</span> {bottomUnit?.name} (‡∏ó‡∏≥‡πÑ‡∏î‡πâ {bottomUnit?.percentAchieved6m.toFixed(1)}% ‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤)</p>
                                </div>
                                <div className="bg-white p-3 rounded border border-sky-100 text-slate-600 text-xs leading-relaxed">
                                    <strong>‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞:</strong> ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà {avgProgress.toFixed(1)}% 
                                    {avgProgress < 30 
                                        ? " ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏£‡πà‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ‡πÅ‡∏•‡∏∞‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£" 
                                        : " ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏î‡∏µ ‡∏Ñ‡∏ß‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á"}
                                </div>
                            </div>
                        </div>
                    );
                };

                return (
                    <div className="space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500">
                        {/* Control Bar */}
                        <div className="flex flex-col md:flex-row justify-between items-center bg-white p-4 rounded-xl border border-sky-100 shadow-sm gap-4 no-print">
                            <div className="flex items-center gap-4 w-full md:w-auto">
                                <div className="flex items-center gap-2">
                                    <ICONS.Hospital />
                                    <span className="font-bold text-slate-700">‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠:</span>
                                </div>
                                <select 
                                    value={selectedDistrict} 
                                    onChange={(e) => setSelectedDistrict(e.target.value)}
                                    className="bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full md:w-64 p-2.5"
                                >
                                    <option value="All">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏ó‡∏∏‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠)</option>
                                    {Object.keys(groupedUnits).map(d => <option key={d} value={d}>{d}</option>)}
                                </select>
                            </div>
                            
                            <button 
                                onClick={handleExportPDF}
                                className="flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg shadow-sm transition-colors font-medium text-sm w-full md:w-auto justify-center"
                            >
                                <ICONS.Printer /> ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô PDF (A4)
                            </button>
                        </div>

                        {/* Analysis Charts for Units (Hidden in PDF to save space or keep if needed, currently kept) */}
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 no-print">
                             <Card>
                                <h3 className="text-lg font-bold text-slate-800 mb-6">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (Top 10 ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£)</h3>
                                <div className="h-64">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <PieChart>
                                            <Pie data={
                                                (selectedDistrict === 'All' ? processedUnitData : processedUnitData.filter(u => u.district === selectedDistrict))
                                                .sort((a,b) => b.value69 - a.value69).slice(0, 10)
                                            } cx="50%" cy="50%" innerRadius={60} outerRadius={80} paddingAngle={5} dataKey="target6m">
                                                {COLORS.map((color, index) => (
                                                    <Cell key={`cell-${index}`} fill={color} />
                                                ))}
                                            </Pie>
                                            <RechartsTooltip formatter={(value) => formatCurrency(value)} />
                                        </PieChart>
                                    </ResponsiveContainer>
                                </div>
                            </Card>
                            <Card>
                                <h3 className="text-lg font-bold text-slate-800 mb-6">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á vs ‡πÄ‡∏õ‡πâ‡∏≤ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (Top 10 ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£)</h3>
                                <div className="h-64">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <BarChart data={
                                            (selectedDistrict === 'All' ? processedUnitData : processedUnitData.filter(u => u.district === selectedDistrict))
                                            .sort((a,b) => b.value69 - a.value69).slice(0, 10)
                                        } layout="vertical" margin={{ top: 5, right: 30, left: 40, bottom: 5 }}>
                                            <CartesianGrid strokeDasharray="3 3" horizontal={false} />
                                            <XAxis type="number" fontSize={10} tickFormatter={(val) => `${(val/1000).toFixed(0)}k`} />
                                            <YAxis dataKey="name" type="category" width={100} fontSize={12} />
                                            <RechartsTooltip formatter={(value) => formatCurrency(value)} cursor={{fill: 'transparent'}} />
                                            <Legend />
                                            <Bar dataKey="value69" name="‡∏ú‡∏•‡∏á‡∏≤‡∏ô 69" fill="#0EA5E9" radius={[0, 4, 4, 0]} barSize={10} />
                                            <Bar dataKey="target6m" name="‡πÄ‡∏õ‡πâ‡∏≤ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô" fill="#CBD5E1" radius={[0, 4, 4, 0]} barSize={10} />
                                        </BarChart>
                                    </ResponsiveContainer>
                                </div>
                            </Card>
                        </div>

                        {/* Printable Area */}
                        <div id="print-area" ref={printRef} className="print-container bg-white p-4">
                            {/* Report Header for PDF Only */}
                            <div className="hidden print-only mb-6 text-center">
                                <h1 className="text-2xl font-bold text-slate-900">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC ‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h1>
                                <p className="text-slate-600">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£ | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà {lastUpdated}</p>
                                {selectedDistrict !== 'All' && <p className="text-blue-600 font-bold mt-2">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠{selectedDistrict}</p>}
                            </div>

                            {/* Grouped Tables */}
                            {Object.keys(groupedUnits).map(districtName => {
                                 if (selectedDistrict !== 'All' && selectedDistrict !== districtName) return null;
                                 
                                 const units = groupedUnits[districtName];
                                 const sum68 = units.reduce((acc, u) => acc + u.value68, 0);
                                 const sum69 = units.reduce((acc, u) => acc + u.value69, 0);
                                 const sumTarget6m = units.reduce((acc, u) => acc + u.target6m, 0);
                                 const sumTarget12m = units.reduce((acc, u) => acc + u.target12m, 0);
                                 
                                 // Calculate % achieved for summary
                                 const sumPercent6m = sumTarget6m > 0 ? (sum69 / sumTarget6m) * 100 : 0;

                                 return (
                                    <div key={districtName} className="mb-8 break-inside-avoid"> {/* Changed Card to div for better print control */}
                                        <div className="border border-sky-200 rounded-xl overflow-hidden shadow-none">
                                            <div className="bg-sky-50 px-6 py-4 border-b border-sky-100 flex justify-between items-center">
                                                <h3 className="text-lg font-bold text-blue-800 flex items-center gap-2">
                                                    <ICONS.Map /> ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠{districtName} <span className="text-sm font-normal text-slate-500">({units.length} ‡πÅ‡∏´‡πà‡∏á)</span>
                                                </h3>
                                            </div>
                                            <div className="overflow-x-auto">
                                                <table className="w-full text-sm text-left text-slate-600">
                                                    <thead className="text-xs text-slate-700 uppercase bg-slate-50 border-b border-slate-200">
                                                        <tr>
                                                            <th className="px-4 py-3">‡∏£‡∏´‡∏±‡∏™</th>
                                                            <th className="px-4 py-3">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</th>
                                                            <th className="px-4 py-3 text-right">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏µ 68</th>
                                                            <th className="px-4 py-3 text-right">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏µ 69</th>
                                                            <th className="px-4 py-3 text-center">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏£‡∏ß‡∏° (%)</th>
                                                            <th className="px-4 py-3 text-right bg-sky-50 text-sky-900">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
                                                            <th className="px-4 py-3 text-center text-emerald-700 font-bold">% ‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤ 6‡∏î.</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {units.map((u, idx) => (
                                                            <tr key={idx} className="bg-white border-b hover:bg-slate-50">
                                                                <td className="px-4 py-2 font-mono text-xs text-slate-400">{u.code}</td>
                                                                <td className="px-4 py-2 font-medium text-slate-900">{u.name}</td>
                                                                <td className="px-4 py-2 text-right font-mono text-xs">{formatNumber(u.value68)}</td>
                                                                <td className="px-4 py-2 text-right font-mono text-blue-600 font-bold">{formatNumber(u.value69)}</td>
                                                                <td className="px-4 py-2 text-center">
                                                                    <span className="bg-slate-100 text-slate-600 py-0.5 px-2 rounded-full text-xs">
                                                                        {u.weight.toFixed(4)}%
                                                                    </span>
                                                                </td>
                                                                <td className="px-4 py-2 text-right font-bold text-blue-700 bg-sky-50">{formatCurrency(u.target6m)}</td>
                                                                <td className="px-4 py-2 text-center">
                                                                    <span className={`px-2 py-1 rounded text-xs font-bold ${u.percentAchieved6m >= 50 ? 'bg-emerald-100 text-emerald-700' : 'bg-orange-100 text-orange-700'}`}>
                                                                        {u.percentAchieved6m.toFixed(2)}%
                                                                    </span>
                                                                </td>
                                                            </tr>
                                                        ))}
                                                        {/* Summary Row */}
                                                        <tr className="bg-sky-100 font-bold text-sky-900">
                                                            <td colSpan="2" className="px-4 py-3 text-right">‡∏£‡∏ß‡∏°‡∏≠‡∏≥‡πÄ‡∏†‡∏≠{districtName}</td>
                                                            <td className="px-4 py-3 text-right">{formatNumber(sum68)}</td>
                                                            <td className="px-4 py-3 text-right">{formatNumber(sum69)}</td>
                                                            <td className="px-4 py-3 text-center">-</td>
                                                            <td className="px-4 py-3 text-right border-t border-sky-300">{formatCurrency(sumTarget6m)}</td>
                                                            <td className="px-4 py-3 text-center border-t border-sky-300">{sumPercent6m.toFixed(2)}%</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            
                                            {/* Analysis Box */}
                                            <div className="p-4 border-t border-sky-100 bg-white">
                                                <DistrictAnalysisBox units={units} districtName={districtName} />
                                            </div>
                                        </div>
                                    </div>
                                 );
                            })}
                            
                            {/* Report Footer */}
                            <div className="hidden print-only mt-8 pt-4 border-t border-slate-300 text-center text-xs text-slate-500">
                                <p>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö Samut Prakan Herbal Strategy (SPHS)</p>
                                <p>‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ ‡∏†‡∏Å.‡∏à‡∏µ‡∏£‡∏†‡∏±‡∏ó‡∏£ ‡∏û‡∏•‡∏≤‡∏¢‡∏á‡∏≤‡∏° | ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£</p>
                            </div>
                        </div>
                    </div>
                );
            };

            const MethodView = () => (
                <div className="max-w-4xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500">
                     <Card>
                        <div className="flex items-center gap-4 mb-6">
                            <div className="p-3 bg-indigo-100 rounded-lg text-indigo-600">
                                <ICONS.Calculator />
                            </div>
                            <div>
                                <h2 className="text-2xl font-bold text-slate-800">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (Methodology)</h2>
                                <p className="text-slate-500">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡∏£‡∏£‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏•‡∏á‡∏≤‡∏ô (Proportional Performance-Based Allocation)</p>
                            </div>
                        </div>
                        <div className="prose prose-slate max-w-none text-slate-600">
                            <p className="mb-4">
                                ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡∏£‡∏£‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏õ‡∏µ 2569 ‡πÉ‡∏ä‡πâ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ <strong>"Weighted Moving Average"</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
                            </p>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                                <div className="bg-blue-50 p-6 rounded-xl border border-blue-100 text-center">
                                    <h3 className="text-4xl font-bold text-blue-600 mb-2">40%</h3>
                                    <p className="text-blue-800 font-medium">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏à‡∏≤‡∏Å‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏µ 2568</p>
                                    <p className="text-xs text-blue-500 mt-2">Historical Baseline</p>
                                </div>
                                <div className="bg-sky-50 p-6 rounded-xl border border-sky-100 text-center">
                                    <h3 className="text-4xl font-bold text-sky-600 mb-2">60%</h3>
                                    <p className="text-sky-800 font-medium">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏à‡∏≤‡∏Å‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏µ 2569</p>
                                    <p className="text-xs text-sky-500 mt-2">Current Performance</p>
                                </div>
                            </div>
                            <p className="bg-slate-50 p-4 rounded-lg border border-slate-200">
                                <strong>‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£:</strong> ‡πÉ‡∏ä‡πâ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ‡πÇ‡∏î‡∏¢‡∏ô‡∏≥‡∏¢‡∏≠‡∏î‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô (Share) ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏≥‡πÑ‡∏õ‡∏Ñ‡∏π‡∏ì‡∏Å‡∏±‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
                            </p>
                            
                            {/* --- NEW CALCULATION EXAMPLES SECTION --- */}
                            <div className="mt-8 space-y-6">
                                <h3 className="text-xl font-bold text-slate-800 border-b pb-2">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (Calculation Examples)</h3>
                                
                                {/* Example 1: District Level */}
                                <div className="bg-white p-6 rounded-xl border border-sky-200 shadow-sm">
                                    <h4 className="text-lg font-bold text-blue-700 mb-3 flex items-center gap-2">
                                        <span className="bg-blue-100 text-blue-800 w-6 h-6 flex items-center justify-center rounded-full text-xs">1</span> 
                                        ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á)
                                    </h4>
                                    <div className="space-y-2 text-sm text-slate-700">
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div className="bg-slate-50 p-3 rounded">
                                                <p className="font-semibold text-slate-900 mb-1">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô (Input Data):</p>
                                                <ul className="list-disc list-inside text-xs space-y-1">
                                                    <li>‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏µ 68 ‡∏Ç‡∏≠‡∏á‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á = <strong>11,048,897</strong> ‡∏ö‡∏≤‡∏ó</li>
                                                    <li>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏õ‡∏µ 68 = <strong>23,748,774</strong> ‡∏ö‡∏≤‡∏ó</li>
                                                    <li>‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏µ 69 ‡∏Ç‡∏≠‡∏á‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á = <strong>2,716,175</strong> ‡∏ö‡∏≤‡∏ó</li>
                                                    <li>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏õ‡∏µ 69 = <strong>6,252,791</strong> ‡∏ö‡∏≤‡∏ó</li>
                                                </ul>
                                            </div>
                                            <div className="bg-blue-50 p-3 rounded">
                                                <p className="font-semibold text-blue-900 mb-1">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Steps):</p>
                                                <ol className="list-decimal list-inside text-xs space-y-1">
                                                    <li><strong>‡∏´‡∏≤‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏µ 68 (Share 68):</strong> <br/>11,048,897 √∑ 23,748,774 = <strong>46.52%</strong></li>
                                                    <li><strong>‡∏´‡∏≤‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏µ 69 (Share 69):</strong> <br/>2,716,175 √∑ 6,252,791 = <strong>43.44%</strong></li>
                                                    <li><strong>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏£‡∏ß‡∏° (Composite Weight):</strong> <br/>(46.52% √ó 0.4) + (43.44% √ó 0.6) <br/>= 18.61% + 26.06% = <strong>44.67%</strong></li>
                                                </ol>
                                            </div>
                                        </div>
                                        <div className="mt-3 p-3 bg-green-50 border border-green-200 rounded text-green-800 text-xs font-semibold">
                                            ‡∏™‡∏£‡∏∏‡∏õ: ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏™‡∏£‡∏£‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô 44.67% ‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏£‡∏ß‡∏°
                                        </div>
                                    </div>
                                </div>

                                {/* Example 2: Unit Level */}
                                <div className="bg-white p-6 rounded-xl border border-sky-200 shadow-sm">
                                    <h4 className="text-lg font-bold text-blue-700 mb-3 flex items-center gap-2">
                                        <span className="bg-blue-100 text-blue-800 w-6 h-6 flex items-center justify-center rounded-full text-xs">2</span> 
                                        ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏•‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏£‡∏û.‡∏™‡∏ï.‡∏™‡∏≥‡πÇ‡∏£‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠)
                                    </h4>
                                    <div className="space-y-2 text-sm text-slate-700">
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div className="bg-slate-50 p-3 rounded">
                                                <p className="font-semibold text-slate-900 mb-1">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô:</p>
                                                <ul className="list-disc list-inside text-xs space-y-1">
                                                    <li>‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏µ 68 ‡∏Ç‡∏≠‡∏á ‡∏£‡∏û.‡∏™‡∏ï. = <strong>254,592</strong> ‡∏ö‡∏≤‡∏ó</li>
                                                    <li>‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏µ 69 ‡∏Ç‡∏≠‡∏á ‡∏£‡∏û.‡∏™‡∏ï. = <strong>102,673</strong> ‡∏ö‡∏≤‡∏ó</li>
                                                    <li>‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô) = <strong>14,620,693.83</strong> ‡∏ö‡∏≤‡∏ó</li>
                                                </ul>
                                            </div>
                                            <div className="bg-blue-50 p-3 rounded">
                                                <p className="font-semibold text-blue-900 mb-1">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì:</p>
                                                <ol className="list-decimal list-inside text-xs space-y-1">
                                                    <li><strong>‡∏´‡∏≤‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏¢‡∏≠‡∏î‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (Unit Share):</strong> <br/>
                                                        Share 68 = 254,592 √∑ 23,748,774 = <strong>1.07%</strong><br/>
                                                        Share 69 = 102,673 √∑ 6,252,791 = <strong>1.64%</strong>
                                                    </li>
                                                    <li><strong>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (Unit Weight):</strong> <br/>
                                                        (1.07% √ó 0.4) + (1.64% √ó 0.6) = <strong>0.99%</strong>
                                                    </li>
                                                    <li><strong>‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô):</strong> <br/>
                                                        14,620,693.83 √ó 0.99% = <strong>145,615.39</strong> ‡∏ö‡∏≤‡∏ó
                                                    </li>
                                                </ol>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* General Formula */}
                                <div className="bg-slate-800 text-white p-6 rounded-xl shadow-lg">
                                    <h4 className="text-lg font-bold text-sky-400 mb-3 flex items-center gap-2">
                                        <ICONS.Calculator /> ‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (General Formula)
                                    </h4>
                                    <div className="font-mono text-sm space-y-4">
                                        <div className="p-3 bg-slate-700 rounded border border-slate-600">
                                            <p className="text-slate-400 text-xs mb-1">‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏£‡∏ß‡∏° (Composite Weight Equation):</p>
                                            <p className="text-emerald-400">Weight = (Share<sub>2568</sub> √ó 0.4) + (Share<sub>2569</sub> √ó 0.6)</p>
                                        </div>
                                        <div className="p-3 bg-slate-700 rounded border border-slate-600">
                                            <p className="text-slate-400 text-xs mb-1">‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (Target Allocation Equation):</p>
                                            <p className="text-yellow-400">Target<sub>Unit</sub> = Target<sub>Province</sub> √ó Weight<sub>Unit</sub></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </Card>
                </div>
            );

            return (
                <div className="min-h-screen flex flex-col lg:flex-row font-sans">
                    {/* Sidebar */}
                    <aside className={`fixed lg:static inset-y-0 left-0 z-40 bg-white border-r border-sky-100 shadow-lg transform transition-transform duration-300 w-72 ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full lg:translate-x-0'}`}>
                        <div className="p-6 border-b border-sky-100">
                            <div className="flex items-start gap-3 text-blue-600">
                                <div className="bg-sky-100 p-2 rounded-lg mt-1">
                                    <ICONS.Dashboard />
                                </div>
                                <div>
                                    <h1 className="font-bold text-md leading-tight text-slate-800">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•<br/>‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC<br/>‡∏à.‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£</h1>
                                    <p className="text-xs text-blue-500 mt-1">‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢<br/>‡∏†‡∏Å.‡∏à‡∏µ‡∏£‡∏†‡∏±‡∏ó‡∏£ ‡∏û‡∏•‡∏≤‡∏¢‡∏á‡∏≤‡∏°</p>
                                </div>
                            </div>
                        </div>
                        <nav className="p-4 space-y-2">
                            <button onClick={() => { setActiveTab('dashboard'); setIsSidebarOpen(false); }} className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${activeTab === 'dashboard' ? 'bg-sky-50 text-blue-700 font-bold shadow-sm ring-1 ring-sky-200' : 'text-slate-600 hover:bg-sky-50 hover:text-blue-600'}`}>
                                <ICONS.TrendingUp /> ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
                            </button>
                            <button onClick={() => { setActiveTab('district'); setIsSidebarOpen(false); }} className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${activeTab === 'district' ? 'bg-sky-50 text-blue-700 font-bold shadow-sm ring-1 ring-sky-200' : 'text-slate-600 hover:bg-sky-50 hover:text-blue-600'}`}>
                                <ICONS.Map /> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠
                            </button>
                            <button onClick={() => { setActiveTab('unit'); setIsSidebarOpen(false); }} className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${activeTab === 'unit' ? 'bg-sky-50 text-blue-700 font-bold shadow-sm ring-1 ring-sky-200' : 'text-slate-600 hover:bg-sky-50 hover:text-blue-600'}`}>
                                <ICONS.Hospital /> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
                            </button>
                            <button onClick={() => { setActiveTab('method'); setIsSidebarOpen(false); }} className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${activeTab === 'method' ? 'bg-sky-50 text-blue-700 font-bold shadow-sm ring-1 ring-sky-200' : 'text-slate-600 hover:bg-sky-50 hover:text-blue-600'}`}>
                                <ICONS.Calculator /> ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
                            </button>
                        </nav>
                        <div className="absolute bottom-0 w-full p-4 border-t border-sky-100 bg-sky-50">
                            <div className="text-xs text-slate-500 text-center">
                                ¬© 2569 ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£<br/>
                                <span className="font-semibold text-blue-600">‡∏†‡∏Å.‡∏à‡∏µ‡∏£‡∏†‡∏±‡∏ó‡∏£ ‡∏û‡∏•‡∏≤‡∏¢‡∏á‡∏≤‡∏°</span>
                            </div>
                        </div>
                    </aside>

                    {/* Main Content */}
                    <main className="flex-1 min-w-0 overflow-y-auto">
                        <header className="bg-white border-b border-sky-100 sticky top-0 z-30 px-6 py-4 flex justify-between items-center shadow-sm no-print">
                            <div className="flex items-center gap-4">
                                <button onClick={() => setIsSidebarOpen(!isSidebarOpen)} className="lg:hidden p-2 hover:bg-sky-50 text-blue-600 rounded-lg"><ICONS.Menu /></button>
                                <h2 className="text-xl font-bold text-slate-800 hidden md:block">
                                    {activeTab === 'dashboard' && 'Dashboard: ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô'}
                                    {activeTab === 'district' && '‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠'}
                                    {activeTab === 'unit' && '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ ‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£'}
                                    {activeTab === 'method' && '‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢'}
                                </h2>
                            </div>
                            <div className="flex items-center gap-3">
                                <span className="text-sm text-slate-500 hidden sm:block">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: {lastUpdated}</span>
                                <button className="flex items-center gap-2 bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-800 transition-colors shadow-md border border-slate-700">
                                    <ICONS.Upload /> <span className="hidden sm:inline">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                                </button>
                            </div>
                        </header>
                        <div className="p-6 max-w-7xl mx-auto">
                            {activeTab === 'dashboard' && <DashboardView />}
                            {activeTab === 'district' && <DistrictView />}
                            {activeTab === 'unit' && <UnitView />}
                            {activeTab === 'method' && <MethodView />}
                        </div>
                    </main>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>