<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC ‡∏à.‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£ (THAIPADI Edition)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- UMD Guard -->
    <script>
        window.module = undefined;
        window.exports = undefined;
        window.define = undefined;
    </script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/17.0.2/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/17.0.2/umd/react-dom.production.min.js"></script>
    
    <!-- Recharts Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prop-types/15.8.1/prop-types.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/classnames/2.3.2/index.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.1.12/Recharts.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Lodash -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>

    <!-- html2pdf.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f8fafc; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        
        /* Print Styles */
        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { background: white; -webkit-print-color-adjust: exact; }
            .card-print { break-inside: avoid; border: 1px solid #ddd; box-shadow: none !important; }
        }
        .print-only { display: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useRef, useEffect } = React;
        const _ = window._;
        const { PieChart, Pie, Cell, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip: RechartsTooltip, Legend, ResponsiveContainer, LineChart, Line, ComposedChart } = window.Recharts;

        // --- ICONS ---
        const ICONS = {
            Dashboard: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>,
            Map: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" x2="9" y1="3" y2="18"/><line x1="15" x2="15" y1="6" y2="21"/></svg>,
            Hospital: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 6V4"/><path d="M16.5 4h-9"/><path d="M18 22v-5"/><path d="M6 22v-5"/><path d="M12 12v5"/><path d="M12 17h-5"/><path d="M12 17h5"/><rect x="4" y="8" width="16" height="14" rx="2"/></svg>,
            Calculator: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>,
            Upload: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>,
            Menu: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>,
            TrendingUp: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>,
            CheckCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>,
            AlertCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>,
            Download: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>,
            Search: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" x2="16.65" y1="21" y2="16.65"/></svg>,
            Lightbulb: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>,
            Award: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>,
            Printer: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>,
            Star: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            CheckSquare: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>,
            Globe: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" x2="22" y1="12" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>,
            Leaf: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z"/><path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/></svg>,
            Analytics: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>,
            ArrowRight: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
        };

        const THEMES = {
            dashboard: { primary: 'blue', bg: 'bg-blue-50', text: 'text-blue-600', border: 'border-blue-200', gradient: 'from-blue-600 to-indigo-600', light: 'bg-blue-100', icon: ICONS.Dashboard },
            national: { primary: 'indigo', bg: 'bg-indigo-50', text: 'text-indigo-600', border: 'border-indigo-200', gradient: 'from-indigo-600 to-violet-600', light: 'bg-indigo-100', icon: ICONS.Globe },
            district: { primary: 'teal', bg: 'bg-teal-50', text: 'text-teal-600', border: 'border-teal-200', gradient: 'from-teal-500 to-emerald-600', light: 'bg-teal-100', icon: ICONS.Map },
            unit: { primary: 'amber', bg: 'bg-amber-50', text: 'text-amber-600', border: 'border-amber-200', gradient: 'from-amber-500 to-orange-600', light: 'bg-amber-100', icon: ICONS.Hospital },
            unitAnalysis: { primary: 'rose', bg: 'bg-rose-50', text: 'text-rose-600', border: 'border-rose-200', gradient: 'from-rose-500 to-pink-600', light: 'bg-rose-100', icon: ICONS.Analytics },
            topDrugs: { primary: 'emerald', bg: 'bg-emerald-50', text: 'text-emerald-600', border: 'border-emerald-200', gradient: 'from-emerald-500 to-green-600', light: 'bg-emerald-100', icon: ICONS.Leaf },
            quality: { primary: 'fuchsia', bg: 'bg-fuchsia-50', text: 'text-fuchsia-600', border: 'border-fuchsia-200', gradient: 'from-fuchsia-600 to-purple-600', light: 'bg-fuchsia-100', icon: ICONS.Star },
            method: { primary: 'slate', bg: 'bg-slate-50', text: 'text-slate-600', border: 'border-slate-200', gradient: 'from-slate-600 to-gray-700', light: 'bg-slate-100', icon: ICONS.Calculator },
        };

        // --- DATA SECTION ---
        const NATIONAL_DATA = {
            levels: [
                { name: '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®', target: 2000000000, value: 622666081, percent: 31.13 },
                { name: '‡πÄ‡∏Ç‡∏ï‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà 6', target: 1650000000, value: 47288810, percent: 28.66 },
                { name: '‡∏à.‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', target: 28381346, value: 8470036, percent: 29.84 }
            ],
            region6: [
                { name: '‡∏â‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏£‡∏≤', target: 23712068, value: 10138903.5, percent: 42.76 },
                { name: '‡∏£‡∏∞‡∏¢‡∏≠‡∏á', target: 20541037, value: 7453387, percent: 36.29 },
                { name: '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', target: 28381346, value: 8470036, percent: 29.84 },
                { name: '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', target: 35000000, value: 8500000, percent: 24.28 },
                { name: '‡∏õ‡∏£‡∏≤‡∏à‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', target: 25000000, value: 5500000, percent: 22.00 },
                { name: '‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß', target: 20000000, value: 4000000, percent: 20.00 },
                { name: '‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', target: 18000000, value: 2500000, percent: 13.88 },
                { name: '‡∏ï‡∏£‡∏≤‡∏î', target: 12000000, value: 726483.5, percent: 6.05 }
            ]
        };

        const TOP_HERBAL_DRUGS_DATA = [
            { name: "‡∏¢‡∏≤‡πÑ‡∏û‡∏•", count: 24710, price: 65, total: 1606150 },
            { name: "‡πÅ‡∏Å‡πâ‡πÑ‡∏≠‡∏°‡∏∞‡∏Ç‡∏≤‡∏°‡∏õ‡πâ‡∏≠‡∏°", count: 17374, price: 84, total: 1459416 },
            { name: "‡∏õ‡∏£‡∏∞‡∏™‡∏∞‡∏°‡∏∞‡πÅ‡∏ß‡πâ‡∏á", count: 24994, price: 50, total: 1249700 },
            { name: "‡∏ü‡πâ‡∏≤‡∏ó‡∏∞‡∏•‡∏≤‡∏¢‡πÇ‡∏à‡∏£", count: 8450, price: 92, total: 777400 },
            { name: "‡πÅ‡∏Å‡πâ‡πÑ‡∏≠‡∏ú‡∏™‡∏°‡∏°‡∏∞‡∏Ç‡∏≤‡∏°‡∏õ‡πâ‡∏≠‡∏° ‡∏™‡∏π‡∏ï‡∏£ 1", count: 6498, price: 84, total: 545832 },
            { name: "‡∏´‡∏≠‡∏°‡πÄ‡∏ó‡∏û‡∏à‡∏¥‡∏ï‡∏£", count: 6623, price: 70, total: 463610 },
            { name: "‡∏Ç‡∏°‡∏¥‡πâ‡∏ô‡∏ä‡∏±‡∏ô", count: 6670, price: 67, total: 446890 },
            { name: "‡∏≠‡∏°‡∏°‡∏∞‡πÅ‡∏ß‡πâ‡∏á", count: 6558, price: 50, total: 327900 },
            { name: "‡∏¢‡∏≤‡∏õ‡∏£‡∏∞‡∏Ñ‡∏ö", count: 2257, price: 100, total: 225700 },
            { name: "‡∏™‡∏´‡∏±‡∏®‡∏ò‡∏≤‡∏£‡∏≤", count: 2883, price: 73, total: 210459 },
            { name: "‡∏°‡∏∞‡∏Ç‡∏≤‡∏°‡πÅ‡∏Ç‡∏Å", count: 5816, price: 31, total: 180296 },
            { name: "‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÑ‡∏û‡∏•", count: 2195, price: 65, total: 142675 },
            { name: "‡πÄ‡∏ñ‡∏≤‡∏ß‡∏±‡∏•‡∏¢‡πå‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏á", count: 1452, price: 84, total: 121968 },
            { name: "‡∏®‡∏∏‡∏Ç‡πÑ‡∏™‡∏¢‡∏≤‡∏®‡∏ô‡πå", count: 166, price: 420, total: 69720 },
            { name: "‡∏¢‡∏≤‡∏Å‡∏£‡∏∞‡πÄ‡∏à‡∏µ‡πä‡∏¢‡∏ö‡πÅ‡∏î‡∏á", count: 797, price: 85, total: 67745 }
        ];

        const PROVINCIAL_TARGETS = {
            month6: 14620692, 
            month10: 21501017,
            month12: 28381344
        };

        const QUALITY_DATA = {
            overall: [
                { id: 1, name: '‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û (CPG & ‡∏¢‡∏≤‡∏ó‡∏î‡πÅ‡∏ó‡∏ô)', score: 100, max: 100 },
                { id: 2, name: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°)', score: 100, max: 100 },
                { id: 3, name: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏¢‡∏≤ 24 ‡∏´‡∏•‡∏±‡∏Å', score: 92.68, max: 100 },
                { id: 4, name: '‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û/‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏¢‡∏≤‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ (GMP)', score: 94.17, max: 100 },
            ],
            drugCodeAccuracy: [
                { name: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', score: 88.61 },
                { name: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', score: 97.73 },
                { name: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', score: 93.94 },
                { name: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', score: 90.58 },
                { name: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', score: 86.60 },
                { name: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', score: 90.79 },
            ]
        };

        const INITIAL_UNIT_DATA_FROM_CSV = [
            // ‡πÄ‡∏°‡∏∑‡∏≠‡∏á (Target Sum: 3,494,583) 
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00933', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏™‡∏≥‡πÇ‡∏£‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠', value68: 254592, value69: 195704, weight: 1.00, target6m: 147578, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00934', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á', value68: 104771, value69: 71977, weight: 0.71, target6m: 104021, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00935', name: '‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏Ø (‡∏ö‡∏≤‡∏á‡∏õ‡∏¥‡πâ‡∏á)', value68: 252528, value69: 316282.5, weight: 2.52, target6m: 368139, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00936', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏õ‡∏π‡πÉ‡∏´‡∏°‡πà', value68: 124732, value69: 116047, weight: 1.08, target6m: 157378, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00937', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÅ‡∏û‡∏£‡∏Å‡∏©‡∏≤', value68: 301506, value69: 120108, weight: 1.46, target6m: 213052, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00938', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡∏á', value68: 67047, value69: 72868, weight: 0.62, target6m: 91229, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00939', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏õ‡∏π', value68: 83277, value69: 88999, weight: 0.90, target6m: 130693, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00940', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏ô', value68: 49057, value69: 20653, weight: 0.24, target6m: 35447, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00941', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà', value68: 349114, value69: 52582, weight: 0.96, target6m: 140315, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00942', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏ó‡∏û‡∏≤‡∏£‡∏±‡∏Å‡∏©‡πå', value68: 404607, value69: 165759, weight: 2.03, target6m: 296147, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00943', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ó‡πâ‡∏≤‡∏¢‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà', value68: 527296, value69: 127099, weight: 1.84, target6m: 268697, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '00944', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÅ‡∏û‡∏£‡∏Å‡∏©‡∏≤‡πÉ‡∏´‡∏°‡πà', value68: 295066, value69: 140449, weight: 1.72, target6m: 250936, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '10685', name: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', value68: 7458559, value69: 1538107.5, weight: 24.96, target6m: 3643853, percent6m: 0 }, 
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '13812', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ó‡πâ‡∏≤‡∏¢‡∏ö‡πâ‡∏≤‡∏ô', value68: 73916, value69: 65810, weight: 0.62, target6m: 90944, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '15048', name: '‡∏®‡∏™‡∏ä. ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', value68: 28784, value69: 15154, weight: 0.18, target6m: 25568, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '23945', name: '‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏Ø (‡∏ß‡∏±‡∏î‡∏ö‡∏≤‡∏á‡∏õ‡∏¥‡πâ‡∏á)', value68: 109445, value69: 13871, weight: 0.30, target6m: 43735, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '24027', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏û‡∏∏‡∏ó‡∏ò‡∏£‡∏±‡∏Å‡∏©‡∏≤', value68: 117409, value69: 98111, weight: 1.01, target6m: 147308, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '24028', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏£‡πà‡∏°‡πÇ‡∏û‡∏ò‡∏¥', value68: 109259, value69: 26572, weight: 0.39, target6m: 57027, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '24029', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏∏‡∏ç‡∏®‡∏¥‡∏£‡∏¥', value68: 22215, value69: 28353, weight: 0.17, target6m: 25171, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '24702', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ï‡∏≥‡∏ö‡∏•‡∏™‡∏≥‡πÇ‡∏£‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠', value68: 48189, value69: 195704, weight: 0.38, target6m: 55407, percent6m: 0 },
            { district: '‡πÄ‡∏°‡∏∑‡∏≠‡∏á', code: '28826', name: '‡∏£‡∏û.‡∏™‡∏ï.‡∏°‡∏±‡∏á‡∏Å‡∏£‡∏ó‡∏≠‡∏á', value68: 254059, value69: 101885, weight: 1.23, target6m: 178839, percent6m: 0 },

            // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á (Target Sum: 1,994,681)
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00964', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏û‡∏∂‡πà‡∏á', value68: 95086, value69: 46976, weight: 0.26, target6m: 37314, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00965', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏à‡∏≤‡∏Å', value68: 28795, value69: 110572, weight: 0.40, target6m: 58468, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00966', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏∏', value68: 91258, value69: 118186, weight: 0.80, target6m: 116999, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00967', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÅ‡∏û‡∏£‡∏Å', value68: 112270, value69: 82956, weight: 0.84, target6m: 122481, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00968', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏™‡∏∑‡∏≠', value68: 23558, value69: 569110, weight: 4.63, target6m: 675224, percent6m: 0 }, 
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00969', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏¢‡∏≠', value68: 182485, value69: 51201, weight: 0.77, target6m: 111794, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00970', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏Å‡∏∞‡πÄ‡∏à‡πâ‡∏≤', value68: 50807, value69: 50728, weight: 0.44, target6m: 63629, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00971', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', value68: 32692, value69: 48472, weight: 0.31, target6m: 45415, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00972', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö', value68: 58465, value69: 28421, weight: 0.34, target6m: 50020, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00973', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏Å‡∏≠‡∏ö‡∏±‡∏ß', value68: 73088, value69: 37491, weight: 0.41, target6m: 59136, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00974', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏Å‡∏≠', value68: 22902, value69: 13868, weight: 0.14, target6m: 20271, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00975', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ó‡∏£‡∏á‡∏Ñ‡∏ô‡∏≠‡∏á', value68: 169940, value69: 54261, weight: 0.73, target6m: 105912, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00976', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏™‡∏≥‡πÇ‡∏£‡∏á', value68: 41137, value69: 60174, weight: 0.58, target6m: 84033, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00977', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏™‡∏≥‡πÇ‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á', value68: 44034, value69: 73723, weight: 0.65, target6m: 94361, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '00978', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏™‡∏≥‡πÇ‡∏£‡∏á‡πÉ‡∏ï‡πâ', value68: 58911, value69: 42414, weight: 0.41, target6m: 60086, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '10754', name: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ö‡∏≤‡∏á‡∏à‡∏≤‡∏Å', value68: 1079436, value69: 492014, weight: 5.10, target6m: 743821, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏õ‡∏£‡∏∞‡πÅ‡∏î‡∏á', code: '23944', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏à‡∏£‡∏¥‡∏ç', value68: 39527, value69: 43018, weight: 0.39, target6m: 56811, percent6m: 0 },

            // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠ (Target Sum: 1,082,899)
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00945', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', value68: 121492, value69: 55162, weight: 0.63, target6m: 91454, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00946', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏£‡∏∞‡∏Å‡∏≤‡∏® ‡∏´‡∏°‡∏π‡πà 3', value68: 132302, value69: 32327, weight: 0.44, target6m: 64937, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00947', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏£‡∏∞‡∏Å‡∏≤‡∏® ‡∏´‡∏°‡∏π‡πà 8', value68: 408397, value69: 86790, weight: 1.35, target6m: 197568, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00948', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ‡∏ô‡πâ‡∏≠‡∏¢ ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà 3', value68: 219135, value69: 104460, weight: 1.19, target6m: 173052, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00949', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ‡∏ô‡πâ‡∏≠‡∏¢ ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà 5', value68: 84530, value69: 38483, weight: 0.42, target6m: 61688, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00950', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ‡∏ô‡πâ‡∏≠‡∏¢ ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà 8', value68: 59246, value69: 23766, weight: 0.28, target6m: 40669, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00951', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÄ‡∏û‡∏£‡∏µ‡∏¢‡∏á', value68: 245369, value69: 91013, weight: 1.11, target6m: 161394, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00952', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏î‡πà‡∏≤‡∏ô ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà 1', value68: 306667, value69: 94386, weight: 1.05, target6m: 153544, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00953', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏î‡πà‡∏≤‡∏ô ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà 13', value68: 126798, value69: 64674, weight: 0.70, target6m: 102391, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00954', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏™‡∏ß‡∏ô', value68: 96457, value69: 63240, weight: 0.70, target6m: 101763, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00955', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏õ‡∏£‡πá‡∏á', value68: 127618, value69: 70140, weight: 0.78, target6m: 114427, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '00956', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ô‡∏¥‡∏¢‡∏°‡∏¢‡∏≤‡∏ï‡∏£‡∏≤', value68: 155008, value69: 73600, weight: 0.83, target6m: 120832, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '10752', name: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', value68: 1155310, value69: 132194, weight: 2.85, target6m: 416221, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '23032', name: '‡∏®‡∏™‡∏ä.‡∏£‡∏û.‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', value68: 20468, value69: 33019, weight: 0.23, target6m: 34189, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '23911', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏î‡πà‡∏≤‡∏ô ‡∏´‡∏°‡∏π‡πà 7', value68: 162530, value69: 37888, weight: 0.52, target6m: 75485, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏ö‡πà‡∏≠', code: '99999', name: '‡∏™‡∏ñ‡∏≤‡∏ô‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡∏à‡∏≥‡∏Å‡∏•‡∏≤‡∏á‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', value68: 0, value69: 79609, weight: 0.00, target6m: 0, percent6m: 0.00 }, // New Unit

            // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ (Target Sum: 790,499)
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00957', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡∏ß', value68: 302124, value69: 106027, weight: 1.40, target6m: 204851, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00958', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ß‡∏±‡∏î‡∏™‡∏•‡∏∏‡∏î', value68: 32771, value69: 24450, weight: 0.23, target6m: 34112, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00959', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡∏õ‡∏•‡∏≤', value68: 24395, value69: 22832, weight: 0.21, target6m: 31261, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00960', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏™‡∏µ‡πà', value68: 43534, value69: 14852, weight: 0.20, target6m: 29040, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00961', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÇ‡∏â‡∏•‡∏á', value68: 67577, value69: 61369, weight: 0.66, target6m: 97002, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00962', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏ó‡∏ß‡∏∞', value68: 92727, value69: 63772, weight: 0.64, target6m: 92769, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '00963', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏´‡∏ô‡∏≠‡∏á‡∏õ‡∏£‡∏∑‡∏≠', value68: 32248, value69: 27632, weight: 0.26, target6m: 37720, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '10753', name: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', value68: 4085593, value69: 438047, weight: 9.79, target6m: 1428631, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '23034', name: '‡∏®‡∏û‡∏ä.‡∏ß‡∏±‡∏î‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ‡πÉ‡∏´‡∏ç‡πà‡∏Å‡∏•‡∏≤‡∏á', value68: 6800, value69: 18830, weight: 0.15, target6m: 21382, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', code: '24675', name: '‡∏£‡∏û.‡∏™‡∏ï.‡∏ö‡∏±‡∏ß‡πÄ‡∏Å‡∏£‡∏≤‡∏∞', value68: 44095, value69: 11241, weight: 0.17, target6m: 24428, percent6m: 0 },

            // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå (Target Sum: 499,834)
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00979', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏∏‡∏ô‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÑ‡∏ó‡∏¢', value68: 21079, value69: 3801, weight: 0.05, target6m: 7064, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00980', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ô‡∏≤‡πÄ‡∏Å‡∏•‡∏∑‡∏≠', value68: 179217, value69: 26437, weight: 0.49, target6m: 71846, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00981', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡∏•‡∏≠‡∏á‡∏ó‡∏∞‡πÄ‡∏•', value68: 56166, value69: 18102, weight: 0.23, target6m: 34071, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00982', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡∏•‡∏≠‡∏á‡∏™‡∏ß‡∏ô', value68: 100265, value69: 29880, weight: 0.31, target6m: 44762, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00983', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÅ‡∏´‡∏•‡∏°‡∏ü‡πâ‡∏≤‡∏ú‡πà‡∏≤', value68: 220385, value69: 53367, weight: 0.81, target6m: 118819, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00984', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏∏‡∏ô‡∏™‡∏°‡∏∏‡∏ó‡∏£', value68: 15071, value69: 3726, weight: 0.06, target6m: 8795, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00985', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÉ‡∏ô‡∏Ñ‡∏•‡∏≠‡∏á‡∏ö‡∏≤‡∏á‡∏õ‡∏•‡∏≤‡∏Å‡∏î', value68: 196259, value69: 102487, weight: 1.09, target6m: 159412, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '00986', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡∏π‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á', value68: 333752, value69: 57531, weight: 1.03, target6m: 149852, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '10755', name: '‡∏£‡∏û.‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå‡∏™‡∏ß‡∏≤‡∏ó‡∏¢‡∏≤‡∏ô‡∏ô‡∏ó‡πå', value68: 262004, value69: 137436, weight: 1.04, target6m: 152146, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '24410', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡∏•‡∏≠‡∏á‡∏ô‡∏≤‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢', value68: 136755, value69: 35616, weight: 0.49, target6m: 70952, percent6m: 0 },
            { district: '‡∏û‡∏£‡∏∞‡∏™‡∏°‡∏∏‡∏ó‡∏£‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå', code: '24559', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡∏≠‡∏≠‡∏°', value68: 74216, value69: 30349, weight: 0.37, target6m: 54071, percent6m: 0 },

            // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á (Target Sum: 607,540)
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00987', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ', value68: 105548, value69: 70292, weight: 0.57, target6m: 83061, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00988', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏™‡∏≤‡∏ò‡∏á‡∏Å‡∏•‡∏≤‡∏á', value68: 55667, value69: 31051, weight: 0.40, target6m: 57776, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00989', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', value68: 0, value69: 0, weight: 0.00, target6m: 0, percent6m: 0.00 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00990', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏®‡∏£‡∏µ‡∏©‡∏∞‡∏à‡∏£‡∏∞‡πÄ‡∏Ç‡πâ‡∏ô‡πâ‡∏≠‡∏¢', value68: 58904, value69: 67385, weight: 0.48, target6m: 70569, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00991', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏®‡∏µ‡∏£‡∏©‡∏∞‡∏à‡∏£‡πÄ‡∏Ç‡πâ‡πÉ‡∏´‡∏ç‡πà', value68: 21626, value69: 34298, weight: 0.10, target6m: 14741, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '00992', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏ß‡∏≤‡∏£‡∏µ‡∏ô‡πâ‡∏≠‡∏¢', value68: 158459, value69: 224423, weight: 2.09, target6m: 305482, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '24411', name: '‡∏£‡∏û‡∏™‡∏ï.‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå', value68: 84072, value69: 78884, weight: 0.67, target6m: 98087, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '24412', name: '‡∏£‡∏û‡∏™‡∏ï.‡∏Å‡∏±‡∏•‡∏õ‡∏û‡∏§‡∏Å‡∏©‡πå', value68: 28910, value69: 39070, weight: 0.27, target6m: 39043, percent6m: 0 },
            { district: '‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', code: '28785', name: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ö‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡∏ò‡∏á', value68: 233949, value69: 61233, weight: 0.74, target6m: 107776, percent6m: 0 }
        ];

        // --- Helpers ---
        const formatCurrency = (val) => new Intl.NumberFormat('th-TH', { style: 'currency', currency: 'THB', minimumFractionDigits: 0 }).format(val);
        const formatNumber = (val) => new Intl.NumberFormat('th-TH').format(val);

        // --- Components ---
        const Card = ({ children, className = "", theme }) => (
            <div className={`bg-white rounded-xl shadow-sm border ${theme ? theme.border : 'border-slate-100'} p-6 transition-all duration-300 hover:shadow-lg card-print ${className}`}>
                {children}
            </div>
        );

        const Header = ({ title, subtitle, icon: Icon, theme }) => (
            <div className={`mb-8 p-6 rounded-2xl bg-gradient-to-r ${theme.gradient} text-white shadow-lg animate-fade-in`}>
                <div className="flex items-start md:items-center gap-4">
                    <div className="p-3 bg-white/20 backdrop-blur-sm rounded-xl">
                        <Icon />
                    </div>
                    <div className="flex-1">
                        <h1 className="text-2xl font-bold">{title}</h1>
                        <p className="text-white/80 mb-1">{subtitle}</p>
                        <div className="inline-block bg-black/10 rounded px-2 py-0.5 mt-1">
                            <p className="text-[10px] text-white/90 font-light flex items-center gap-1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="opacity-70"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                                ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• update ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 18/2/2026 ‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• THAIPADI ‡∏ó‡∏µ‡πà‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å HDC.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        );

        const KPICard = ({ title, value, subtext, icon: Icon, theme, progress }) => (
            <div className={`bg-white rounded-xl p-6 border-l-4 ${theme.border} shadow-sm hover:scale-105 transition-transform duration-300 group`}>
                <div className="flex justify-between items-start mb-4">
                    <div>
                        <p className="text-slate-500 text-sm font-medium mb-1">{title}</p>
                        <h3 className={`text-2xl font-bold ${theme.text} group-hover:scale-110 transition-transform origin-left`}>{value}</h3>
                    </div>
                    <div className={`p-3 rounded-xl ${theme.light} ${theme.text}`}>
                        <Icon />
                    </div>
                </div>
                {progress !== undefined && (
                    <div className="w-full bg-slate-100 rounded-full h-2 mb-2 overflow-hidden">
                        <div className={`h-full rounded-full bg-gradient-to-r ${theme.gradient} transition-all duration-1000`} style={{ width: `${Math.min(progress, 100)}%` }}></div>
                    </div>
                )}
                {subtext && <p className="text-xs text-slate-400">{subtext}</p>}
            </div>
        );

        // --- INFOGRAPHICS COMPONENTS ---
        const MethodInfographic = ({ theme }) => (
            <div className="grid grid-cols-1 md:grid-cols-3 gap-8 my-8 relative">
                <div className="absolute top-1/2 left-0 w-full h-1 bg-slate-100 -z-10 hidden md:block transform -translate-y-1/2"></div>
                {[
                    { title: "‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", desc: "‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏õ‡∏µ 68 ‡πÅ‡∏•‡∏∞ 69", icon: "üìä", step: "01" },
                    { title: "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô", desc: "‡∏´‡∏≤ % Share ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î", icon: "‚ûó", step: "02" },
                    { title: "Weighted Average", desc: "‡∏ñ‡πà‡∏ß‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (68=40%, 69=60%)", icon: "‚öñÔ∏è", step: "03" }
                ].map((step, idx) => (
                    <div key={idx} className="bg-white p-6 rounded-2xl border border-slate-200 text-center relative hover:-translate-y-2 transition-transform duration-300">
                        <div className={`w-12 h-12 ${theme.bg} ${theme.text} rounded-full flex items-center justify-center font-bold text-lg mx-auto mb-4 border-4 border-white shadow-lg`}>
                            {step.step}
                        </div>
                        <div className="text-4xl mb-2">{step.icon}</div>
                        <h3 className="font-bold text-slate-800 mb-1">{step.title}</h3>
                        <p className="text-sm text-slate-500">{step.desc}</p>
                    </div>
                ))}
            </div>
        );

        const TopDrugsPodium = ({ data }) => {
            const sorted = [...data].sort((a,b) => b.total - a.total).slice(0,3);
            return (
                <div className="flex items-end justify-center gap-4 h-64 mb-12 px-4">
                    {/* 2nd Place */}
                    <div className="w-1/3 max-w-[150px] flex flex-col items-center animate-fade-in delay-200">
                        <div className="text-center mb-2">
                            <span className="text-2xl">ü•à</span>
                            <p className="font-bold text-xs md:text-sm text-slate-700 truncate w-full">{sorted[1].name}</p>
                            <p className="text-xs text-slate-500">{formatNumber(sorted[1].total)}‡∏ø</p>
                        </div>
                        <div className="w-full bg-slate-200 rounded-t-lg shadow-inner h-32 flex items-end justify-center pb-4 text-4xl font-bold text-white/50">2</div>
                    </div>
                    {/* 1st Place */}
                    <div className="w-1/3 max-w-[150px] flex flex-col items-center animate-fade-in z-10">
                        <div className="text-center mb-2">
                            <span className="text-4xl">üëë</span>
                            <p className="font-bold text-sm md:text-base text-emerald-700 truncate w-full">{sorted[0].name}</p>
                            <p className="text-xs font-bold text-emerald-600">{formatNumber(sorted[0].total)}‡∏ø</p>
                        </div>
                        <div className="w-full bg-gradient-to-t from-emerald-500 to-green-400 rounded-t-lg shadow-lg h-48 flex items-end justify-center pb-4 text-6xl font-bold text-white/30">1</div>
                    </div>
                    {/* 3rd Place */}
                    <div className="w-1/3 max-w-[150px] flex flex-col items-center animate-fade-in delay-300">
                        <div className="text-center mb-2">
                            <span className="text-2xl">ü•â</span>
                            <p className="font-bold text-xs md:text-sm text-amber-700 truncate w-full">{sorted[2].name}</p>
                            <p className="text-xs text-amber-500">{formatNumber(sorted[2].total)}‡∏ø</p>
                        </div>
                        <div className="w-full bg-amber-100 rounded-t-lg shadow-inner h-24 flex items-end justify-center pb-4 text-4xl font-bold text-amber-900/20">3</div>
                    </div>
                </div>
            );
        };

        const RegionRaceBar = ({ data, theme }) => (
            <div className="space-y-4">
                {data.sort((a,b) => b.percent - a.percent).map((item, index) => (
                    <div key={index} className="relative">
                        <div className="flex justify-between text-sm mb-1">
                            <span className={`font-bold ${item.name === '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£' ? 'text-emerald-600' : 'text-slate-600'}`}>
                                {index + 1}. {item.name}
                            </span>
                            <span className="font-mono">{item.percent.toFixed(2)}%</span>
                        </div>
                        <div className="w-full bg-slate-100 rounded-full h-4 overflow-hidden shadow-inner">
                            <div 
                                className={`h-full rounded-full transition-all duration-1000 ease-out flex items-center justify-end pr-2 text-[10px] text-white font-bold
                                ${item.name === '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£' ? 'bg-gradient-to-r from-emerald-500 to-green-400' : `bg-gradient-to-r ${theme.gradient} opacity-70`}`}
                                style={{ width: `${Math.min(item.percent, 100)}%` }}
                            >
                                {item.percent > 10 && formatNumber(item.value)}
                            </div>
                        </div>
                    </div>
                ))}
            </div>
        );

        // --- MAIN APP ---
        function App() {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [isSidebarOpen, setIsSidebarOpen] = useState(true);
            const [lastUpdated] = useState('19 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569');

            // Data Processing
            const processedUnitData = useMemo(() => INITIAL_UNIT_DATA_FROM_CSV.map(u => ({
                ...u,
                target12m: u.weight / 100 * PROVINCIAL_TARGETS.month12,
                percentAchieved6m: u.target6m > 0 ? (u.value69 / u.target6m) * 100 : 0
            })), []);

            const processedDistrictData = useMemo(() => {
                const grouped = _.groupBy(processedUnitData, 'district');
                return Object.keys(grouped).map(d => {
                    const units = grouped[d];
                    const sumTarget6m = _.sumBy(units, 'target6m');
                    return {
                        name: d,
                        value68: _.sumBy(units, 'value68'),
                        value69: _.sumBy(units, 'value69'),
                        weight: _.sumBy(units, 'weight'),
                        target6m: sumTarget6m,
                        target12m: _.sumBy(units, 'target12m'),
                        // Changed key from 'percent' to 'achievement' to avoid conflict with Recharts 'percent' prop
                        achievement: sumTarget6m > 0 ? (_.sumBy(units, 'value69') / sumTarget6m * 100) : 0
                    };
                }).sort((a,b) => b.weight - a.weight);
            }, [processedUnitData]);

            const currentTheme = THEMES[activeTab] || THEMES.dashboard;

            // Views
            const DashboardView = () => {
                const totalUsage = processedDistrictData.reduce((acc, cur) => acc + cur.value69, 0);
                const progress = (totalUsage / PROVINCIAL_TARGETS.month6) * 100;
                
                return (
                    <div className="space-y-6 animate-in fade-in slide-in-from-bottom-4">
                        <Header title="Dashboard ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î" subtitle="‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏¢‡∏≤‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏ö‡∏ö Real-time" icon={currentTheme.icon} theme={currentTheme} />
                        
                        {/* KPI Grid */}
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            <KPICard title="‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏õ‡∏µ 69" value={formatCurrency(totalUsage)} subtext="‡∏™‡∏∞‡∏™‡∏°‡∏ñ‡∏∂‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô" icon={ICONS.TrendingUp} theme={currentTheme} progress={progress} />
                            <KPICard title="‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô" value={formatCurrency(PROVINCIAL_TARGETS.month6)} subtext="Target ‡∏£‡∏∞‡∏¢‡∏∞‡∏™‡∏±‡πâ‡∏ô" icon={ICONS.Map} theme={currentTheme} />
                            <KPICard title="‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤" value={`${progress.toFixed(2)}%`} subtext="‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏õ‡πâ‡∏≤ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô" icon={progress >= 50 ? ICONS.CheckCircle : ICONS.AlertCircle} theme={currentTheme} />
                            <KPICard title="‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏µ" value={formatCurrency(PROVINCIAL_TARGETS.month12)} subtext="Target ‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ‡∏á‡∏ö‡∏Ø" icon={ICONS.Calculator} theme={currentTheme} />
                        </div>

                        {/* Charts Area */}
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <Card theme={currentTheme}>
                                <h3 className={`text-lg font-bold mb-4 ${currentTheme.text}`}>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (Target Proportion)</h3>
                                <div className="h-80">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <PieChart>
                                            <Pie 
                                                data={processedDistrictData} 
                                                cx="50%" 
                                                cy="50%" 
                                                innerRadius={70} 
                                                outerRadius={100} 
                                                paddingAngle={2} 
                                                dataKey="target12m" 
                                                nameKey="name"
                                                // Fixed label percentage calculation
                                                label={({ name, percent }) => `${name} ${(percent * 100).toFixed(2)}%`}
                                            >
                                                {processedDistrictData.map((entry, index) => (
                                                    <Cell key={`cell-${index}`} fill={['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#6366F1'][index % 6]} strokeWidth={2} stroke="#fff" />
                                                ))}
                                            </Pie>
                                            <RechartsTooltip formatter={(val) => formatCurrency(val)} />
                                            <Legend verticalAlign="bottom" height={36}/>
                                        </PieChart>
                                    </ResponsiveContainer>
                                </div>
                            </Card>
                            <Card theme={currentTheme}>
                                <h3 className={`text-lg font-bold mb-4 ${currentTheme.text}`}>‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏™‡∏°‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</h3>
                                <div className="h-80">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <ComposedChart data={processedDistrictData} layout="vertical" margin={{top: 5, right: 30, left: 40, bottom: 5}}>
                                            <CartesianGrid stroke="#f1f5f9" horizontal={false} />
                                            <XAxis type="number" hide />
                                            <YAxis dataKey="name" type="category" width={100} tick={{fontSize: 12}} />
                                            <RechartsTooltip formatter={(val) => formatCurrency(val)} />
                                            <Bar dataKey="value69" barSize={15} fill="#3B82F6" radius={[0, 10, 10, 0]} background={{ fill: '#f1f5f9' }} />
                                            <Bar dataKey="target6m" barSize={5} fill="#cbd5e1" radius={[0, 10, 10, 0]} />
                                        </ComposedChart>
                                    </ResponsiveContainer>
                                </div>
                            </Card>
                        </div>

                        {/* Inspection Summary Card */}
                        <Card theme={currentTheme} className="border-2 border-blue-200">
                            <div className="flex items-center gap-3 mb-6 border-b border-blue-100 pb-4">
                                <div className={`p-3 rounded-lg bg-blue-600 text-white shadow-lg`}>
                                    <ICONS.Award />
                                </div>
                                <div>
                                    <h3 className="text-xl font-bold text-blue-800">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ (Inspection Summary)</h3>
                                    <p className="text-sm text-blue-500">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç</p>
                                </div>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <div className="space-y-6">
                                    <div className="bg-blue-50 rounded-xl p-5 border border-blue-100">
                                        <h4 className="font-bold text-blue-900 mb-4 flex items-center gap-2">
                                            <span className="w-6 h-6 rounded-full bg-blue-200 flex items-center justify-center text-xs">1</span> 
                                            ‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì (Quantitative)
                                        </h4>
                                        <div className="flex justify-between items-center text-sm mb-2">
                                            <span className="text-slate-600">‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î:</span>
                                            <span className="font-medium">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC</span>
                                        </div>
                                        <div className="flex justify-between items-center text-sm mb-2">
                                            <span className="text-slate-600">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô (Weight):</span>
                                            <span className="font-medium">‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞ 70</span>
                                        </div>
                                        <div className="flex justify-between items-center text-sm mb-2">
                                            <span className="text-slate-600">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ (Raw Score):</span>
                                            <span className="font-bold text-blue-600">5.00</span>
                                        </div>
                                        <div className="mt-3 pt-3 border-t border-blue-200 flex justify-between items-center">
                                            <span className="font-bold text-blue-800">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° (Weighted):</span>
                                            <span className="font-bold text-2xl text-blue-700">3.50</span>
                                        </div>
                                    </div>

                                    <div className="bg-purple-50 rounded-xl p-5 border border-purple-100">
                                        <h4 className="font-bold text-purple-900 mb-4 flex items-center gap-2">
                                            <span className="w-6 h-6 rounded-full bg-purple-200 flex items-center justify-center text-xs">2</span> 
                                            ‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û (Qualitative/Outcome)
                                        </h4>
                                        <div className="flex justify-between items-center text-sm mb-2">
                                            <span className="text-slate-600">‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î:</span>
                                            <span className="font-medium">‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ & ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô</span>
                                        </div>
                                        <div className="flex justify-between items-center text-sm mb-2">
                                            <span className="text-slate-600">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô (Weight):</span>
                                            <span className="font-medium">‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞ 30</span>
                                        </div>
                                        <div className="flex justify-between items-center text-sm mb-2">
                                            <span className="text-slate-600">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:</span>
                                            <span className="font-bold text-purple-600">93.50</span>
                                        </div>
                                        <div className="mt-3 pt-3 border-t border-purple-200 flex justify-between items-center">
                                            <span className="font-bold text-purple-800">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° (Weighted):</span>
                                            <span className="font-bold text-2xl text-purple-700">2.81</span>
                                        </div>
                                    </div>

                                    <div className="bg-gradient-to-r from-emerald-500 to-green-600 rounded-xl p-6 text-white shadow-lg flex justify-between items-center">
                                        <div>
                                            <h4 className="font-bold text-lg mb-1">‡∏£‡∏ß‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</h4>
                                            <p className="text-emerald-100 text-sm">Total Performance Score</p>
                                        </div>
                                        <div className="text-5xl font-bold">6.31</div>
                                    </div>
                                    
                                    <div className="text-xs text-slate-500 italic bg-slate-50 p-3 rounded border border-slate-200">
                                        <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° 6.31 ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì (3.50) ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û (2.81) ‡∏ã‡∏∂‡πà‡∏á‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
                                    </div>
                                </div>

                                <div>
                                    <h4 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                                        <ICONS.CheckSquare /> ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û (Outcome Detail)
                                    </h4>
                                    <div className="overflow-hidden rounded-xl border border-slate-200">
                                        <table className="w-full text-sm text-left">
                                            <thead className="text-xs uppercase bg-slate-100 text-slate-600">
                                                <tr>
                                                    <th className="px-4 py-3">‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</th>
                                                    <th className="px-4 py-3 text-center">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏°</th>
                                                    <th className="px-4 py-3 text-center">‡πÑ‡∏î‡πâ</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-slate-100">
                                                {QUALITY_DATA.overall.map((item, index) => (
                                                    <tr key={index} className="hover:bg-slate-50">
                                                        <td className="px-4 py-3 text-slate-700">{item.name}</td>
                                                        <td className="px-4 py-3 text-center text-slate-500">{item.max}</td>
                                                        <td className="px-4 py-3 text-center font-bold text-purple-600">{item.score}</td>
                                                    </tr>
                                                ))}
                                                <tr className="bg-purple-50 font-bold text-purple-900">
                                                    <td className="px-4 py-3 text-right">‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏£‡∏ß‡∏°</td>
                                                    <td className="px-4 py-3 text-center">100</td>
                                                    <td className="px-4 py-3 text-center">93.50</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </Card>
                    </div>
                );
            };

            const NationalView = () => (
                <div className="space-y-6">
                    <Header title="‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏® & ‡πÄ‡∏Ç‡∏ï‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û" subtitle="‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏°‡∏´‡∏†‡∏≤‡∏Ñ" icon={currentTheme.icon} theme={currentTheme} />
                    
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        {NATIONAL_DATA.levels.map((item, index) => (
                            <div key={index} className="bg-white p-6 rounded-2xl shadow-sm border border-indigo-100 relative overflow-hidden group">
                                <div className={`absolute top-0 right-0 p-4 opacity-10 transform translate-x-4 -translate-y-4 group-hover:scale-150 transition-transform duration-500`}>
                                    <ICONS.Globe size={100} />
                                </div>
                                <h3 className="text-slate-500 font-medium mb-2">{item.name}</h3>
                                <div className="text-4xl font-bold text-indigo-900 mb-4">{item.percent.toFixed(2)}%</div>
                                <div className="w-full bg-slate-100 rounded-full h-2">
                                    <div className="h-full bg-indigo-500 rounded-full" style={{width: `${Math.min(item.percent, 100)}%`}}></div>
                                </div>
                                <div className="mt-4 flex justify-between text-xs text-slate-500">
                                    <span>‡∏ú‡∏•‡∏á‡∏≤‡∏ô: {formatNumber(item.value)}</span>
                                    <span>‡πÄ‡∏õ‡πâ‡∏≤: {formatNumber(item.target)}</span>
                                </div>
                            </div>
                        ))}
                    </div>

                    <Card theme={currentTheme}>
                        <h3 className="text-xl font-bold text-indigo-900 mb-6 flex items-center gap-2">
                            <span className="bg-indigo-100 p-1 rounded">üèÜ</span> ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà 6
                        </h3>
                        <RegionRaceBar data={NATIONAL_DATA.region6} theme={currentTheme} />
                    </Card>
                </div>
            );

            const DistrictView = () => (
                <div className="space-y-6">
                    <Header title="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠" subtitle="‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà" icon={currentTheme.icon} theme={currentTheme} />
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                        {processedDistrictData.map((d, i) => (
                            <div key={i} className="bg-white rounded-xl shadow-sm border border-teal-100 overflow-hidden hover:shadow-md transition-shadow">
                                <div className={`h-2 w-full bg-gradient-to-r ${d.achievement >= 50 ? 'from-emerald-400 to-green-500' : d.achievement >= 35 ? 'from-amber-400 to-orange-500' : 'from-red-400 to-rose-500'}`}></div>
                                <div className="p-5">
                                    <div className="flex justify-between items-start mb-4">
                                        <h3 className="font-bold text-lg text-slate-800">{d.name}</h3>
                                        <span className={`px-2 py-1 rounded text-xs font-bold ${d.achievement >= 50 ? 'bg-emerald-100 text-emerald-700' : 'bg-orange-100 text-orange-700'}`}>
                                            {d.achievement.toFixed(2)}%
                                        </span>
                                    </div>
                                    <div className="space-y-3 text-sm">
                                        <div className="flex justify-between">
                                            <span className="text-slate-500">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏µ 69</span>
                                            <span className="font-bold text-teal-700">{formatNumber(d.value69)}</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span className="text-slate-500">‡πÄ‡∏õ‡πâ‡∏≤ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span>
                                            <span className="font-mono text-slate-600">{formatNumber(d.target6m)}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>

                    <Card theme={currentTheme}>
                        <h3 className="font-bold text-teal-900 mb-4">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</h3>
                        <div className="overflow-x-auto">
                            <table className="w-full text-sm text-left text-slate-600">
                                <thead className="text-xs text-white uppercase bg-teal-600">
                                    <tr>
                                        <th className="px-6 py-3 rounded-tl-lg">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</th>
                                        <th className="px-6 py-3 text-right">‡∏ú‡∏•‡∏á‡∏≤‡∏ô 69</th>
                                        <th className="px-6 py-3 text-right">‡πÄ‡∏õ‡πâ‡∏≤ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
                                        <th className="px-6 py-3 text-center rounded-tr-lg">% Achievement</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {processedDistrictData.map((d, i) => (
                                        <tr key={i} className="border-b hover:bg-teal-50">
                                            <td className="px-6 py-4 font-medium">{d.name}</td>
                                            <td className="px-6 py-4 text-right font-mono text-teal-700 font-bold">{formatNumber(d.value69)}</td>
                                            <td className="px-6 py-4 text-right font-mono">{formatNumber(d.target6m)}</td>
                                            <td className="px-6 py-4 text-center">
                                                <div className="w-full bg-slate-200 rounded-full h-2.5">
                                                    <div className={`h-2.5 rounded-full ${d.achievement >= 50 ? 'bg-emerald-500' : 'bg-orange-500'}`} style={{width: `${Math.min(d.achievement, 100)}%`}}></div>
                                                </div>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </Card>
                </div>
            );

            const UnitView = () => {
                const [selectedDistrict, setSelectedDistrict] = useState('All');
                const groupedUnits = useMemo(() => _.groupBy(processedUnitData, 'district'), []);
                
                // Helper for Auto Analysis
                const getAnalysisText = (units) => {
                    const total = units.length;
                    const pass = units.filter(u => u.percentAchieved6m >= 50).length;
                    const zero = units.filter(u => u.value69 === 0).length;
                    
                    return (
                        <div className="bg-amber-50 p-6 rounded-xl border border-amber-200 mt-8">
                            <h3 className="text-lg font-bold text-amber-800 mb-3 flex items-center gap-2">
                                <ICONS.Lightbulb /> ‡∏ö‡∏ó‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (Automated Analysis)
                            </h3>
                            <ul className="space-y-2 text-sm text-slate-700">
                                <li className="flex gap-2">
                                    <span className="text-amber-500">‚Ä¢</span>
                                    <span>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏°‡∏µ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <strong>{total} ‡πÅ‡∏´‡πà‡∏á</strong> ‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span>
                                </li>
                                <li className="flex gap-2">
                                    <span className="text-green-500">‚Ä¢</span>
                                    <span>‡∏°‡∏µ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (50%+) ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô <strong className="text-green-600">{pass} ‡πÅ‡∏´‡πà‡∏á</strong> ‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô {((pass/total)*100).toFixed(1)}%</span>
                                </li>
                                {zero > 0 && (
                                    <li className="flex gap-2">
                                        <span className="text-red-500">‚Ä¢</span>
                                        <span>‡∏û‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢ (Zero Active) ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô <strong className="text-red-600">{zero} ‡πÅ‡∏´‡πà‡∏á</strong> ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏£‡πà‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ</span>
                                    </li>
                                )}
                                <li className="flex gap-2">
                                    <span className="text-blue-500">‚Ä¢</span>
                                    <span><strong>‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞:</strong> ‡∏Ñ‡∏ß‡∏£‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 35% ‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ú‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏° Top Performers</span>
                                </li>
                            </ul>
                        </div>
                    );
                };

                return (
                    <div className="space-y-6">
                        <Header title="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£" subtitle="‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ (‡∏£‡∏û./‡∏£‡∏û.‡∏™‡∏ï.)" icon={currentTheme.icon} theme={currentTheme} />
                        
                        <div className="flex justify-between items-center bg-amber-50 p-4 rounded-xl border border-amber-200 mb-6">
                            <div className="flex items-center gap-3">
                                <span className="font-bold text-amber-900">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà:</span>
                                <select 
                                    className="bg-white border border-amber-300 text-amber-900 text-sm rounded-lg p-2.5 outline-none focus:ring-2 focus:ring-amber-500"
                                    value={selectedDistrict}
                                    onChange={(e) => setSelectedDistrict(e.target.value)}
                                >
                                    <option value="All">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                    {Object.keys(groupedUnits).map(d => <option key={d} value={d}>{d}</option>)}
                                </select>
                            </div>
                        </div>

                        <div className="bg-white rounded-xl border border-amber-100 shadow-sm overflow-hidden">
                            {Object.keys(groupedUnits).map(district => {
                                if (selectedDistrict !== 'All' && selectedDistrict !== district) return null;
                                const units = groupedUnits[district];
                                return (
                                    <div key={district} className="mb-8 last:mb-0">
                                        <div className="bg-amber-100 px-6 py-3 font-bold text-amber-800 flex justify-between">
                                            <span>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠{district}</span>
                                            <span className="text-xs bg-white px-2 py-1 rounded-full text-amber-600">{units.length} ‡∏´‡∏ô‡πà‡∏ß‡∏¢</span>
                                        </div>
                                        <table className="w-full text-sm">
                                            <thead className="bg-slate-50 text-xs text-slate-500 uppercase border-b">
                                                <tr>
                                                    <th className="px-6 py-3 text-left">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</th>
                                                    <th className="px-6 py-3 text-right">‡∏ú‡∏•‡∏á‡∏≤‡∏ô 69</th>
                                                    <th className="px-6 py-3 text-right">‡πÄ‡∏õ‡πâ‡∏≤ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
                                                    <th className="px-6 py-3 text-center">% ‡∏ú‡∏•‡∏á‡∏≤‡∏ô</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {units.map((u, i) => (
                                                    <tr key={i} className="border-b hover:bg-amber-50/50 transition-colors">
                                                        <td className="px-6 py-3 font-medium text-slate-700">{u.name}</td>
                                                        <td className="px-6 py-3 text-right font-mono text-amber-700">{formatNumber(u.value69)}</td>
                                                        <td className="px-6 py-3 text-right font-mono text-slate-500">{formatNumber(u.target6m)}</td>
                                                        <td className="px-6 py-3 text-center">
                                                            <span className={`px-2 py-0.5 rounded text-xs font-bold ${u.percentAchieved6m >= 50 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>
                                                                {u.percentAchieved6m.toFixed(2)}%
                                                            </span>
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                )
                            })}
                        </div>
                        
                        {/* Auto Generated Analysis Footer */}
                        {getAnalysisText(selectedDistrict === 'All' ? processedUnitData : processedUnitData.filter(u => u.district === selectedDistrict))}
                    </div>
                );
            };

            const UnitAnalysisView = () => {
                const [selectedDistrict, setSelectedDistrict] = useState('All');
                
                // Filter Data
                const filteredUnits = useMemo(() => {
                    return selectedDistrict === 'All' 
                        ? processedUnitData 
                        : processedUnitData.filter(u => u.district === selectedDistrict);
                }, [selectedDistrict, processedUnitData]);

                // Calculate Stats
                const stats = useMemo(() => {
                    const totalTarget = filteredUnits.reduce((a, b) => a + b.target6m, 0);
                    const totalResult = filteredUnits.reduce((a, b) => a + b.value69, 0);
                    const avgPercent = totalTarget > 0 ? (totalResult / totalTarget) * 100 : 0;
                    return { totalTarget, totalResult, avgPercent };
                }, [filteredUnits]);

                // SWOT Generator
                const generateSWOT = () => {
                    const topUnits = [...filteredUnits].sort((a,b) => b.percentAchieved6m - a.percentAchieved6m).slice(0,3);
                    const lowUnits = filteredUnits.filter(u => u.percentAchieved6m < 30);
                    
                    return (
                        <div className="bg-white rounded-xl shadow-lg border border-rose-100 overflow-hidden mt-6">
                            <div className="bg-gradient-to-r from-rose-500 to-pink-600 px-6 py-4 text-white flex justify-between items-center">
                                <h3 className="font-bold text-lg flex items-center gap-2"><ICONS.Analytics /> ‡∏ö‡∏ó‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å (Strategic Analysis)</h3>
                                <span className="bg-white/20 px-3 py-1 rounded-full text-xs">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: {selectedDistrict === 'All' ? '‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î' : `‡∏≠.${selectedDistrict}`}</span>
                            </div>
                            <div className="p-6 grid grid-cols-1 md:grid-cols-3 gap-6">
                                {/* Strengths */}
                                <div className="space-y-3">
                                    <h4 className="font-bold text-emerald-600 flex items-center gap-2 border-b border-emerald-100 pb-2">
                                        <span className="bg-emerald-100 p-1 rounded">üëç</span> ‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á (Strengths)
                                    </h4>
                                    <ul className="text-sm text-slate-600 space-y-2 list-disc list-inside">
                                        <li>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ó‡∏≥‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ {stats.avgPercent.toFixed(2)}% ‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</li>
                                        <li>‡∏°‡∏µ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡πâ‡∏ô‡πÅ‡∏ö‡∏ö (Top 3) ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà {topUnits.map(u => u.name.split('‡∏£‡∏û‡∏™‡∏ï.')[1] || u.name).join(', ')}</li>
                                        <li>‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥</li>
                                    </ul>
                                </div>
                                {/* Weaknesses */}
                                <div className="space-y-3">
                                    <h4 className="font-bold text-rose-600 flex items-center gap-2 border-b border-rose-100 pb-2">
                                        <span className="bg-rose-100 p-1 rounded">üëé</span> ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î (Weaknesses)
                                    </h4>
                                    <ul className="text-sm text-slate-600 space-y-2 list-disc list-inside">
                                        <li>‡∏û‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ {lowUnits.length} ‡πÅ‡∏´‡πà‡∏á ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 30%</li>
                                        <li>‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏¢‡∏±‡∏á‡∏Å‡∏£‡∏∞‡∏à‡∏∏‡∏Å‡∏ï‡∏±‡∏ß‡πÉ‡∏ô‡∏ö‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</li>
                                        {stats.avgPercent < 50 && <li>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡πÄ‡∏Å‡∏ì‡∏ë‡πå 50% ‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ</li>}
                                    </ul>
                                </div>
                                {/* Development */}
                                <div className="space-y-3">
                                    <h4 className="font-bold text-blue-600 flex items-center gap-2 border-b border-blue-100 pb-2">
                                        <span className="bg-blue-100 p-1 rounded">üöÄ</span> ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤ (Development)
                                    </h4>
                                    <ul className="text-sm text-slate-600 space-y-2 list-disc list-inside">
                                        <li>‡∏à‡∏±‡∏î‡πÄ‡∏ß‡∏ó‡∏µ‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ (KM) ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ Top 3 ‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</li>
                                        <li>‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏¥‡πÄ‡∏ó‡∏®‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô</li>
                                        <li>‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏π‡∏á (Top Drugs) ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    );
                };

                return (
                    <div className="space-y-6">
                        <Header title="‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" subtitle="Deep Dive Analysis & Strategic Planning" icon={currentTheme.icon} theme={currentTheme} />
                        
                        {/* Filter Control */}
                        <div className="flex justify-end mb-6">
                            <div className="flex items-center gap-3 bg-white px-4 py-2 rounded-lg border border-rose-200 shadow-sm">
                                <span className="text-sm font-bold text-rose-700">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå:</span>
                                <select 
                                    className="bg-rose-50 border-none text-sm font-medium text-rose-900 rounded focus:ring-0 cursor-pointer"
                                    value={selectedDistrict}
                                    onChange={(e) => setSelectedDistrict(e.target.value)}
                                >
                                    <option value="All">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Overview)</option>
                                    {Object.keys(_.groupBy(processedUnitData, 'district')).map(d => <option key={d} value={d}>{d}</option>)}
                                </select>
                            </div>
                        </div>

                        {/* Summary Dashboard Cards */}
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div className="bg-white p-5 rounded-xl border-l-4 border-rose-400 shadow-sm">
                                <p className="text-slate-500 text-xs uppercase font-bold">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏£‡∏ß‡∏° (6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</p>
                                <h3 className="text-2xl font-bold text-slate-800 mt-1">{formatNumber(stats.totalTarget)}</h3>
                            </div>
                            <div className="bg-white p-5 rounded-xl border-l-4 border-pink-500 shadow-sm">
                                <p className="text-slate-500 text-xs uppercase font-bold">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏£‡∏ß‡∏° (69)</p>
                                <h3 className="text-2xl font-bold text-pink-600 mt-1">{formatNumber(stats.totalResult)}</h3>
                            </div>
                            <div className="bg-white p-5 rounded-xl border-l-4 border-rose-600 shadow-sm flex justify-between items-center">
                                <div>
                                    <p className="text-slate-500 text-xs uppercase font-bold">% ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤</p>
                                    <h3 className={`text-3xl font-bold mt-1 ${stats.avgPercent >= 50 ? 'text-green-500' : 'text-rose-600'}`}>{stats.avgPercent.toFixed(2)}%</h3>
                                </div>
                                <div className="h-12 w-12 rounded-full border-4 border-slate-100 flex items-center justify-center text-xs font-bold text-slate-400">
                                    KPI
                                </div>
                            </div>
                        </div>

                        {/* SWOT Analysis Section */}
                        {generateSWOT()}

                        {/* Top/Bottom Lists */}
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                            <Card theme={currentTheme} className="bg-gradient-to-br from-green-50 to-emerald-50 border-emerald-200">
                                <h3 className="font-bold text-emerald-800 flex items-center gap-2 mb-4">
                                    <span className="bg-emerald-200 p-1 rounded">üåü</span> Top Performers (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö)
                                </h3>
                                <ul className="space-y-3">
                                    {filteredUnits.sort((a,b) => b.percentAchieved6m - a.percentAchieved6m).slice(0,5).map((u, i) => (
                                        <li key={i} className="bg-white p-3 rounded-lg shadow-sm flex justify-between items-center">
                                            <div className="flex items-center gap-3">
                                                <span className="font-bold text-emerald-500 text-lg">#{i+1}</span>
                                                <span className="text-sm font-medium">{u.name}</span>
                                            </div>
                                            <span className="font-bold text-emerald-600">{u.percentAchieved6m.toFixed(0)}%</span>
                                        </li>
                                    ))}
                                </ul>
                            </Card>

                            <Card theme={currentTheme} className="bg-gradient-to-br from-red-50 to-rose-50 border-rose-200">
                                <h3 className="font-bold text-rose-800 flex items-center gap-2 mb-4">
                                    <span className="bg-rose-200 p-1 rounded">‚ö°</span> Critical Attention (‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î 5 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö)
                                </h3>
                                <ul className="space-y-3">
                                    {filteredUnits.filter(u => u.target6m > 0).sort((a,b) => a.percentAchieved6m - b.percentAchieved6m).slice(0,5).map((u, i) => (
                                        <li key={i} className="bg-white p-3 rounded-lg shadow-sm flex justify-between items-center">
                                            <div className="flex items-center gap-3">
                                                <span className="font-bold text-rose-500 text-lg">!</span>
                                                <span className="text-sm font-medium">{u.name}</span>
                                            </div>
                                            <span className="font-bold text-rose-600">{u.percentAchieved6m.toFixed(0)}%</span>
                                        </li>
                                    ))}
                                </ul>
                            </Card>
                        </div>
                    </div>
                );
            };

            const TopDrugsView = () => (
                <div className="space-y-6">
                    <Header title="15 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏¢‡∏≤‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£" subtitle="‡∏¢‡∏≠‡∏î‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì" icon={currentTheme.icon} theme={currentTheme} />
                    
                    {/* Infographic Podium */}
                    <TopDrugsPodium data={TOP_HERBAL_DRUGS_DATA} />

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
                        {TOP_HERBAL_DRUGS_DATA.slice(3).map((item, index) => (
                            <div key={index} className="bg-white p-4 rounded-xl shadow-sm border border-emerald-100 flex items-center gap-4 hover:bg-emerald-50 transition-colors">
                                <div className="w-10 h-10 rounded-full bg-emerald-100 flex items-center justify-center font-bold text-emerald-600">
                                    {index + 4}
                                </div>
                                <div>
                                    <h4 className="font-bold text-slate-800 text-sm">{item.name}</h4>
                                    <p className="text-xs text-slate-500">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤: {formatNumber(item.total)} ‡∏ö‡∏≤‡∏ó</p>
                                </div>
                            </div>
                        ))}
                    </div>

                    {/* Detailed Data Table */}
                    <Card theme={currentTheme}>
                        <h3 className="font-bold text-emerald-800 mb-4 flex items-center gap-2">
                            <ICONS.Leaf /> ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≤ (Detailed Data)
                        </h3>
                        <div className="overflow-x-auto rounded-lg border border-emerald-100">
                            <table className="w-full text-sm text-left">
                                <thead className="bg-emerald-50 text-emerald-900 font-bold uppercase text-xs">
                                    <tr>
                                        <th className="px-4 py-3">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th>
                                        <th className="px-4 py-3">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤</th>
                                        <th className="px-4 py-3 text-right">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á (Visit)</th>
                                        <th className="px-4 py-3 text-right">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏Ñ‡∏≠‡∏£‡πå‡∏™ (‡∏ö‡∏≤‡∏ó)</th>
                                        <th className="px-4 py-3 text-right">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th>
                                    </tr>
                                </thead>
                                <tbody className="divide-y divide-emerald-50">
                                    {TOP_HERBAL_DRUGS_DATA.sort((a,b) => b.total - a.total).map((item, index) => (
                                        <tr key={index} className="hover:bg-emerald-50/50 transition-colors">
                                            <td className="px-4 py-3 text-center font-bold text-emerald-600">{index + 1}</td>
                                            <td className="px-4 py-3 font-medium text-slate-800">{item.name}</td>
                                            <td className="px-4 py-3 text-right font-mono text-slate-600">{formatNumber(item.count)}</td>
                                            <td className="px-4 py-3 text-right font-mono text-slate-600">{formatNumber(item.price)}</td>
                                            <td className="px-4 py-3 text-right font-mono font-bold text-emerald-700">{formatNumber(item.total)}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                        
                        {/* Analytical Note Box */}
                        <div className="mt-6 bg-slate-50 p-6 rounded-xl border border-slate-200">
                            <h4 className="font-bold text-slate-800 mb-2 flex items-center gap-2">
                                <ICONS.Search /> ‡∏ö‡∏ó‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (Comprehensive Analysis)
                            </h4>
                            <p className="text-sm text-slate-600 leading-relaxed">
                                ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 15 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏¢‡∏≤‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‡∏û‡∏ö‡∏ß‡πà‡∏≤ <strong>‡∏¢‡∏≤‡πÑ‡∏û‡∏•</strong> ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏¢‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏≤‡∏¢‡πÉ‡∏à (‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏Å‡πâ‡πÑ‡∏≠‡∏°‡∏∞‡∏Ç‡∏≤‡∏°‡∏õ‡πâ‡∏≠‡∏°, ‡∏ü‡πâ‡∏≤‡∏ó‡∏∞‡∏•‡∏≤‡∏¢‡πÇ‡∏à‡∏£) ‡∏°‡∏µ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ‡∏ã‡∏∂‡πà‡∏á‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÇ‡∏£‡∏Ñ‡∏õ‡∏ß‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡πÇ‡∏£‡∏Ñ‡∏´‡∏ß‡∏±‡∏î‡∏ï‡∏≤‡∏°‡∏§‡∏î‡∏π‡∏Å‡∏≤‡∏• ‡∏¢‡∏≤‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏° Top 5 ‡∏Ñ‡∏£‡∏≠‡∏á‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏Å‡∏ß‡πà‡∏≤ 50% ‡∏Ç‡∏≠‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏£‡∏ß‡∏° ‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢ ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏° ‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏ö‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡πÄ‡∏ä‡πà‡∏ô ‡∏®‡∏∏‡∏Ç‡πÑ‡∏™‡∏¢‡∏≤‡∏®‡∏ô‡πå) ‡πÅ‡∏°‡πâ‡∏à‡∏∞‡∏°‡∏µ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≠‡∏¢‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏° ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏°‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏Å‡∏•‡πâ‡∏ä‡∏¥‡∏î
                            </p>
                        </div>
                    </Card>
                </div>
            );

            const QualityView = () => (
                <div className="space-y-6">
                    <Header title="‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û" subtitle="Quality & Standards Monitoring" icon={currentTheme.icon} theme={currentTheme} />
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                        {QUALITY_DATA.overall.map((q, i) => (
                            <div key={i} className="bg-white p-6 rounded-2xl shadow-sm border border-fuchsia-100 relative overflow-hidden">
                                <div className="flex justify-between items-end mb-2 relative z-10">
                                    <h3 className="font-bold text-slate-700 w-3/4">{q.name}</h3>
                                    <span className="text-3xl font-bold text-fuchsia-600">{q.score}</span>
                                </div>
                                <div className="w-full bg-slate-100 rounded-full h-3 relative z-10">
                                    <div className="h-full bg-gradient-to-r from-fuchsia-500 to-purple-500 rounded-full" style={{width: `${q.score}%`}}></div>
                                </div>
                                {/* Decorative BG Icon */}
                                <div className="absolute -bottom-4 -right-4 text-fuchsia-50 opacity-50 z-0">
                                    <ICONS.CheckCircle width={100} height={100} />
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );

            const MethodView = () => (
                <div className="space-y-6">
                    <Header title="‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢" subtitle="Methodology & Calculation Logic" icon={currentTheme.icon} theme={currentTheme} />
                    
                    {/* Visual Flowchart */}
                    <MethodInfographic theme={currentTheme} />

                    <div className="bg-slate-800 text-white p-8 rounded-3xl shadow-xl text-center relative overflow-hidden">
                        <div className="relative z-10">
                            <h3 className="text-2xl font-bold mb-6">‡∏™‡∏π‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Formula)</h3>
                            <div className="font-mono text-lg md:text-2xl bg-white/10 p-6 rounded-xl inline-block border border-white/20">
                                Weight = (Share<sub>68</sub> √ó 40%) + (Share<sub>69</sub> √ó 60%)
                            </div>
                            <p className="mt-6 text-slate-400 max-w-2xl mx-auto">
                                ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡∏£‡∏£‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ä‡πâ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ Weighted Moving Average ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
                            </p>
                        </div>
                        {/* Background blobs */}
                        <div className="absolute top-0 left-0 w-64 h-64 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 -translate-x-1/2 -translate-y-1/2"></div>
                        <div className="absolute bottom-0 right-0 w-64 h-64 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 translate-x-1/2 translate-y-1/2"></div>
                    </div>
                </div>
            );

            return (
                <div className="flex min-h-screen bg-slate-50 font-sans text-slate-900">
                    {/* Sidebar */}
                    <aside className={`fixed inset-y-0 left-0 z-50 w-72 bg-white border-r border-slate-200 transform transition-transform duration-300 lg:translate-x-0 ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full'}`}>
                        <div className="p-6 border-b border-slate-100 flex items-center gap-3">
                            <div className={`w-10 h-10 rounded-xl bg-gradient-to-br ${currentTheme.gradient} flex items-center justify-center text-white shadow-lg`}>
                                <ICONS.Leaf />
                            </div>
                            <div>
                                <h1 className="font-bold text-slate-800 leading-none">SPHS</h1>
                                <p className="text-xs text-slate-400 mt-1">Herbal Strategy System</p>
                            </div>
                        </div>
                        <nav className="p-4 space-y-1 overflow-y-auto h-[calc(100vh-100px)] custom-scrollbar">
                            {[
                                { id: 'national', label: '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®/‡πÄ‡∏Ç‡∏ï', icon: ICONS.Globe },
                                { id: 'dashboard', label: '‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î', icon: ICONS.Dashboard },
                                { id: 'district', label: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏≠‡∏≥‡πÄ‡∏†‡∏≠', icon: ICONS.Map },
                                { id: 'unit', label: '‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£', icon: ICONS.Hospital },
                                { id: 'unitAnalysis', label: '‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å', icon: ICONS.Analytics },
                                { id: 'topDrugs', label: '15 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏¢‡∏≤', icon: ICONS.Leaf },
                                { id: 'quality', label: '‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û (QA)', icon: ICONS.Star },
                                { id: 'method', label: '‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì', icon: ICONS.Calculator },
                            ].map((menu) => (
                                <button
                                    key={menu.id}
                                    onClick={() => { setActiveTab(menu.id); setIsSidebarOpen(false); }}
                                    className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 group
                                        ${activeTab === menu.id 
                                            ? `bg-gradient-to-r ${THEMES[menu.id].gradient} text-white shadow-md` 
                                            : 'text-slate-600 hover:bg-slate-50'}`}
                                >
                                    <div className={`${activeTab === menu.id ? 'text-white' : THEMES[menu.id].text}`}>
                                        <menu.icon />
                                    </div>
                                    <span className={`font-medium ${activeTab !== menu.id && 'group-hover:text-slate-900'}`}>{menu.label}</span>
                                    {activeTab === menu.id && <div className="ml-auto"><ICONS.ArrowRight size={16} /></div>}
                                </button>
                            ))}
                        </nav>
                        <div className="absolute bottom-0 w-full p-4 border-t border-slate-100 bg-white text-xs text-center text-slate-400">
                            v2.5 THAIPADI Ed. <br/> Dev by ‡∏†‡∏Å.‡∏à‡∏µ‡∏£‡∏†‡∏±‡∏ó‡∏£ ‡∏û‡∏•‡∏≤‡∏¢‡∏á‡∏≤‡∏°
                        </div>
                    </aside>

                    {/* Main Content */}
                    <main className="flex-1 lg:ml-72 min-w-0 transition-all duration-300">
                        {/* Mobile Header */}
                        <div className="lg:hidden bg-white border-b p-4 flex justify-between items-center sticky top-0 z-40">
                            <div className="font-bold text-slate-800">SPHS Mobile</div>
                            <button onClick={() => setIsSidebarOpen(!isSidebarOpen)} className="p-2 bg-slate-100 rounded-lg">
                                <ICONS.Menu />
                            </button>
                        </div>

                        <div className="p-4 md:p-8 max-w-7xl mx-auto">
                            {/* Content Injection */}
                            {activeTab === 'dashboard' && <DashboardView />}
                            {activeTab === 'national' && <NationalView />}
                            {activeTab === 'district' && <DistrictView />}
                            {activeTab === 'unit' && <UnitView />}
                            {activeTab === 'unitAnalysis' && <UnitAnalysisView />}
                            {activeTab === 'topDrugs' && <TopDrugsView />}
                            {activeTab === 'quality' && <QualityView />}
                            {activeTab === 'method' && <MethodView />}
                        </div>
                    </main>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>