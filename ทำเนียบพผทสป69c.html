<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ทำเนียบบุคลากร การแพทย์แผนไทยและการแพทย์ทางเลือกจังหวัดสมุทรปราการ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans Thai', sans-serif; scroll-behavior: smooth; }
        .card-hover:hover { transform: translateY(-10px); box-shadow: 0 40px 80px -20px rgba(16, 185, 129, 0.25); }
        .workplace-box { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; min-height: 4rem; line-height: 1.4; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f8fafc; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #10b981; border-radius: 10px; }
        input[type="file"]::file-selector-button {
            background-color: #10b981; color: white; border: none; padding: 10px 20px; border-radius: 12px; cursor: pointer; font-weight: bold; margin-right: 15px; transition: 0.3s;
        }
        input[type="file"]::file-selector-button:hover { background-color: #059669; }
        
        /* Passcode UI Styles */
        .pin-dot { width: 16px; height: 16px; border-radius: 50%; border: 2px solid #10b981; transition: all 0.2s; }
        .pin-dot.active { background-color: #10b981; box-shadow: 0 0 15px rgba(16, 185, 129, 0.5); }
        .num-pad-btn {
            width: 70px; height: 70px; border-radius: 50%; background: white; border: 1px solid #e2e8f0;
            display: flex; items-center; justify-center; font-size: 1.5rem; font-weight: 900; color: #1e293b;
            transition: all 0.2s; cursor: pointer;
        }
        .num-pad-btn:hover { background: #f0fdf4; border-color: #10b981; color: #10b981; transform: scale(1.05); }
        .num-pad-btn:active { transform: scale(0.9); background: #10b981; color: white; }
    </style>
</head>
<body class="bg-[#F8FAFC] text-slate-900 custom-scrollbar overflow-x-hidden">

    <!-- 1. Passcode Screen -->
    <div id="passcodeScreen" class="fixed inset-0 z-[100] bg-white flex flex-col items-center justify-center p-6">
        <div class="max-w-md w-full text-center space-y-10">
            <div class="space-y-4">
                <div class="w-20 h-20 bg-emerald-100 text-emerald-600 rounded-3xl mx-auto flex items-center justify-center shadow-xl shadow-emerald-100">
                    <i data-lucide="lock" class="w-10 h-10"></i>
                </div>
                <h1 class="text-3xl font-black text-slate-800 tracking-tighter">เข้าสู่ระบบทำเนียบ</h1>
                <p class="text-slate-400 font-bold">กรุณาใส่รหัสผ่าน 5 หลักเพื่อเข้าใช้งาน</p>
            </div>

            <!-- PIN Display -->
            <div class="flex justify-center gap-4 py-4">
                <div class="pin-dot" id="dot-0"></div>
                <div class="pin-dot" id="dot-1"></div>
                <div class="pin-dot" id="dot-2"></div>
                <div class="pin-dot" id="dot-3"></div>
                <div class="pin-dot" id="dot-4"></div>
            </div>

            <!-- Error Message -->
            <p id="pinError" class="text-rose-500 font-bold text-sm opacity-0 transition-opacity">รหัสผ่านไม่ถูกต้อง กรุณาลองใหม่</p>

            <!-- Number Pad -->
            <div class="grid grid-cols-3 gap-6 max-w-[280px] mx-auto">
                <button class="num-pad-btn" onclick="appendPin('1')">1</button>
                <button class="num-pad-btn" onclick="appendPin('2')">2</button>
                <button class="num-pad-btn" onclick="appendPin('3')">3</button>
                <button class="num-pad-btn" onclick="appendPin('4')">4</button>
                <button class="num-pad-btn" onclick="appendPin('5')">5</button>
                <button class="num-pad-btn" onclick="appendPin('6')">6</button>
                <button class="num-pad-btn" onclick="appendPin('7')">7</button>
                <button class="num-pad-btn" onclick="appendPin('8')">8</button>
                <button class="num-pad-btn" onclick="appendPin('9')">9</button>
                <div class="flex items-center justify-center">
                    <button class="text-slate-300 hover:text-emerald-500 transition-colors font-bold" onclick="clearPin()">ล้าง</button>
                </div>
                <button class="num-pad-btn" onclick="appendPin('0')">0</button>
                <button class="flex items-center justify-center text-slate-300 hover:text-rose-500 transition-colors" onclick="backspacePin()">
                    <i data-lucide="delete"></i>
                </button>
            </div>
            
            <div class="pt-10">
                <p class="text-[10px] text-slate-300 uppercase tracking-[0.3em] font-black italic leading-loose">
                    Office of Traditional Medicine<br>Samut Prakan Health Network
                </p>
            </div>
        </div>
    </div>

    <!-- 2. Main App Content (Hidden by default) -->
    <div id="mainApp" class="hidden">
        <!-- Security Banner -->
        <div id="helpBanner" class="bg-emerald-950 text-white py-4 px-6 shadow-2xl sticky top-0 z-50 border-b border-emerald-800 backdrop-blur-md bg-opacity-95">
            <div class="max-w-7xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4">
                <div class="flex items-center gap-4 text-left">
                    <div class="bg-emerald-500/20 p-2.5 rounded-2xl border border-emerald-500/30">
                        <i data-lucide="shield-check" class="w-6 h-6 text-emerald-400"></i>
                    </div>
                    <div>
                        <p class="text-sm font-black tracking-wide leading-tight uppercase">
                            Authorized Account: <span class="text-yellow-400 font-black">jeerapat2010@gmail.com</span>
                        </p>
                        <p class="text-[10px] opacity-60 uppercase tracking-[0.2em] font-bold mt-1 tracking-widest text-emerald-100">
                            DATA PROCESSOR V5.1 • ประมวลผลข้อมูลสถานที่ทำงานและอายุครบถ้วน
                        </p>
                    </div>
                </div>
                <button onclick="this.parentElement.parentElement.style.display='none'" class="text-[10px] bg-white/10 hover:bg-white/20 text-white px-6 py-2.5 rounded-xl font-black transition-all border border-white/10 uppercase tracking-widest">
                    ปิดการแจ้งเตือน
                </button>
            </div>
        </div>

        <!-- Header Section -->
        <header class="bg-white pt-20 pb-28 px-6 border-b border-slate-100 relative overflow-hidden">
            <div class="absolute top-0 right-0 w-[700px] h-[700px] bg-emerald-50 rounded-full -translate-y-1/2 translate-x-1/2 blur-[150px] opacity-40"></div>
            <div class="max-w-7xl mx-auto relative z-10 text-center lg:text-left">
                <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-12">
                    <div class="space-y-8 lg:w-2/3">
                        <div class="inline-flex items-center gap-2 px-5 py-2 bg-emerald-50 text-emerald-700 rounded-full text-xs font-black tracking-widest uppercase border border-emerald-100">
                            <i data-lucide="heart" class="w-4 h-4 fill-emerald-600"></i>
                            Directory Secure System
                        </div>
                        <h1 class="text-4xl md:text-5xl lg:text-7xl font-black text-slate-900 tracking-tighter leading-[1.1]">
                            ทำเนียบบุคลากร <br class="hidden md:block">
                            <span class="text-emerald-600">การแพทย์แผนไทยและการแพทย์ทางเลือก</span><br>
                            <span class="text-slate-400 font-medium italic">จังหวัดสมุทรปราการ</span>
                        </h1>
                    </div>

                    <!-- CSV Upload Box -->
                    <div class="bg-white p-8 rounded-[3rem] shadow-2xl border border-emerald-100 flex flex-col items-center lg:items-start gap-6 max-w-md mx-auto lg:mx-0">
                        <div class="flex items-center gap-4 mb-2">
                            <div class="p-4 bg-emerald-600 rounded-2xl shadow-lg">
                                <i data-lucide="upload-cloud" class="w-6 h-6 text-white"></i>
                            </div>
                            <h3 class="text-xl font-black text-slate-800 tracking-tight">อัปโหลดไฟล์ CSV ล่าสุด</h3>
                        </div>
                        <p class="text-xs text-slate-400 font-bold leading-relaxed mb-2">ประมวลผลข้อมูลใหม่ทุกครั้งที่เข้าใช้งาน (ตัดชื่อซ้ำอัตโนมัติ)</p>
                        <input type="file" id="csvFileInput" accept=".csv" class="text-sm text-slate-500 cursor-pointer w-full" />
                    </div>
                </div>

                <!-- Controls Area -->
                <div class="mt-20 flex flex-col lg:flex-row gap-5 bg-white p-4 rounded-[2.5rem] shadow-[0_50px_100px_-20px_rgba(0,0,0,0.1)] border border-slate-100 ring-[15px] ring-slate-50/50">
                    <div class="flex-grow relative group">
                        <i data-lucide="search" class="absolute left-8 top-1/2 -translate-y-1/2 text-slate-300 w-8 h-8 group-focus-within:text-emerald-500 transition-all"></i>
                        <input
                            id="searchInput"
                            type="text"
                            placeholder="ค้นหาชื่อ, เบอร์โทร, หรือหน่วยงาน..."
                            class="w-full pl-20 pr-10 py-7 bg-transparent focus:outline-none text-2xl font-bold placeholder:text-slate-200 tracking-tight"
                        />
                    </div>
                    <div class="lg:w-[45%] relative border-t lg:border-t-0 lg:border-l border-slate-100">
                        <i data-lucide="filter" class="absolute left-8 top-1/2 -translate-y-1/2 text-slate-300 w-7 h-7"></i>
                        <select 
                            id="workplaceFilter"
                            class="w-full pl-20 pr-16 py-7 bg-transparent appearance-none focus:outline-none cursor-pointer font-black text-slate-600 text-xl tracking-tight"
                        >
                            <option value="all">แสดงหน่วยงานทั้งหมด</option>
                        </select>
                        <div class="absolute right-8 top-1/2 -translate-y-1/2 pointer-events-none text-slate-300">
                            <i data-lucide="chevron-down" class="w-7 h-7"></i>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="max-w-7xl mx-auto py-24 px-6 text-center">
            <div id="statsSection" class="flex flex-col md:flex-row items-center justify-between mb-16 gap-10 px-6 opacity-0 transition-opacity duration-1000">
                <div class="flex items-center gap-8">
                    <div class="w-20 h-20 bg-emerald-600 rounded-[2rem] shadow-2xl flex items-center justify-center text-white rotate-6">
                        <i data-lucide="users" class="w-10 h-10"></i>
                    </div>
                    <div class="text-left">
                        <h3 class="text-slate-400 font-black text-[14px] tracking-[0.4em] uppercase leading-none mb-4">Database Summary</h3>
                        <p id="resultCount" class="text-6xl font-black text-slate-900 leading-none tracking-tighter">
                            กรุณาเลือกไฟล์...
                        </p>
                    </div>
                </div>
            </div>

            <div id="personnelGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-12 lg:gap-14">
                <!-- Empty state initially -->
                <div class="col-span-full py-40 text-center bg-white rounded-[4rem] border-4 border-dashed border-slate-100">
                    <div class="w-32 h-32 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-10">
                        <i data-lucide="database" class="w-16 h-16 text-slate-200"></i>
                    </div>
                    <h3 class="text-3xl font-black text-slate-900 mb-4 tracking-tighter">กรุณาอัปโหลดไฟล์ CSV เพื่อประมวลผลข้อมูล</h3>
                    <p class="text-slate-400 font-bold italic text-lg">ข้อมูลจะถูกตรวจสอบพิกัด และ คำนวณอายุรายบุคคลทันที</p>
                </div>
            </div>
        </main>

        <!-- Footer Area -->
        <footer class="mt-40 max-w-7xl mx-auto px-6">
            <div class="bg-slate-950 rounded-[5rem] p-20 text-white flex flex-col lg:flex-row justify-between items-center gap-20 shadow-2xl relative overflow-hidden group">
                <div class="flex flex-col md:flex-row items-center gap-16 relative z-10 text-center lg:text-left">
                    <div id="totalBadge" class="w-40 h-40 bg-emerald-600 rounded-[4rem] flex items-center justify-center text-8xl font-black border-[12px] border-emerald-500/20 shadow-2xl">
                        0
                    </div>
                    <div class="space-y-4">
                        <div class="text-emerald-400 font-black text-base tracking-[0.5em] uppercase leading-none">Security System Active</div>
                        <div class="text-3xl font-black tracking-tighter uppercase leading-tight">
                            กลุ่มงานการแพทย์แผนไทยและการแพทย์ทางเลือก
                        </div>
                    </div>
                </div>
                <div class="inline-flex items-center gap-6 px-10 py-5 bg-white/5 border border-white/10 rounded-3xl text-xl text-slate-400 font-bold backdrop-blur-2xl">
                    <i data-lucide="shield-check" class="w-6 h-6 text-emerald-500"></i>
                    jeerapat2010@gmail.com
                </div>
            </div>
        </footer>
    </div>

    <script>
        // --- Passcode Logic ---
        let currentPin = "";
        const CORRECT_PIN = "13579"; // รหัสผ่านใหม่ 5 หลัก

        function appendPin(num) {
            if (currentPin.length < CORRECT_PIN.length) {
                currentPin += num;
                updatePinDisplay();
                if (currentPin.length === CORRECT_PIN.length) {
                    setTimeout(verifyPin, 100);
                }
            }
        }

        function clearPin() {
            currentPin = "";
            updatePinDisplay();
            document.getElementById('pinError').classList.add('opacity-0');
        }

        function backspacePin() {
            currentPin = currentPin.slice(0, -1);
            updatePinDisplay();
            document.getElementById('pinError').classList.add('opacity-0');
        }

        function updatePinDisplay() {
            for (let i = 0; i < 5; i++) {
                const dot = document.getElementById(`dot-${i}`);
                if (i < currentPin.length) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            }
        }

        function verifyPin() {
            if (currentPin === CORRECT_PIN) {
                document.getElementById('passcodeScreen').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                lucide.createIcons();
            } else {
                document.getElementById('pinError').classList.remove('opacity-0');
                currentPin = "";
                setTimeout(updatePinDisplay, 300);
            }
        }

        // --- Main App Logic ---
        let allPersonnelData = [];
        const TODAY = new Date(2026, 0, 9);

        const csvFileInput = document.getElementById('csvFileInput');
        const personnelGrid = document.getElementById('personnelGrid');
        const workplaceFilter = document.getElementById('workplaceFilter');
        const searchInput = document.getElementById('searchInput');
        const resultCount = document.getElementById('resultCount');
        const totalBadge = document.getElementById('totalBadge');
        const statsSection = document.getElementById('statsSection');

        csvFileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(event) {
                const text = event.target.result;
                processCSV(text);
            };
            reader.readAsText(file, 'UTF-8');
        });

        function processCSV(csvText) {
            const lines = csvText.split(/\r?\n/);
            const mappedData = [];
            const seenNames = new Set();

            for (let i = 1; i < lines.length; i++) {
                if (!lines[i].trim()) continue;
                
                // Regex handling CSV columns with quotes
                const cols = lines[i].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c => c.replace(/^"|"$/g, '').trim());
                if (cols.length < 5) continue;

                const name = cols[0];
                const surname = cols[1];
                const identifier = `${name} ${surname}`;

                if (seenNames.has(identifier)) continue;
                seenNames.add(identifier);

                mappedData.push({
                    name: name,
                    surname: surname,
                    nickname: cols[2] || "",
                    photoId: extractDriveId(cols[3]),
                    workplace: cols[4] || "ไม่ระบุ",
                    position: cols[5] || "ไม่ระบุ",
                    dob: cols[6] || "",
                    phone: cols[7] || "",
                    type: cols[8] || "พนักงาน"
                });
            }

            allPersonnelData = mappedData.sort((a, b) => a.name.localeCompare(b.name, 'th'));
            populateFilter(allPersonnelData);
            statsSection.classList.remove('opacity-0');
            updateDisplay();
        }

        function extractDriveId(url) {
            if (!url) return "";
            if (url.includes('id=')) return url.split('id=')[1].split('&')[0];
            return url;
        }

        function populateFilter(data) {
            const workplaces = [...new Set(data.map(p => p.workplace))].sort();
            workplaceFilter.innerHTML = `<option value="all">แสดงหน่วยงานทั้งหมด (${data.length} ราย)</option>`;
            workplaces.forEach(place => {
                const opt = document.createElement('option');
                opt.value = place;
                opt.textContent = place;
                workplaceFilter.appendChild(opt);
            });
        }

        function calculateAge(dobStr) {
            if (!dobStr) return "ไม่ระบุ";
            const parts = dobStr.split('/');
            if (parts.length !== 3) return "ไม่ระบุ";
            
            const [d, m, y] = parts.map(Number);
            const birthDate = new Date(y, m - 1, d);
            
            let years = TODAY.getFullYear() - birthDate.getFullYear();
            let months = TODAY.getMonth() - birthDate.getMonth();
            
            if (months < 0 || (months === 0 && TODAY.getDate() < birthDate.getDate())) {
                years--;
                months += 12;
            }
            if (TODAY.getDate() < birthDate.getDate()) {
                months--;
            }
            return `${years} ปี ${months >= 0 ? months : 0} เดือน`;
        }

        function updateDisplay() {
            const query = searchInput.value.toLowerCase().trim();
            const filter = workplaceFilter.value;

            const filtered = allPersonnelData.filter(p => {
                const textMatch = `${p.name} ${p.surname} ${p.nickname} ${p.workplace} ${p.phone} ${p.position}`.toLowerCase().includes(query);
                const workplaceMatch = filter === 'all' || p.workplace === filter;
                return textMatch && workplaceMatch;
            });

            resultCount.textContent = `พบ ${filtered.length} รายชื่อ`;
            totalBadge.textContent = filtered.length;
            personnelGrid.innerHTML = '';

            if (filtered.length === 0) {
                personnelGrid.innerHTML = `
                    <div class="col-span-full py-40 text-center bg-white rounded-[4rem] border-4 border-dashed border-slate-100">
                        <div class="w-32 h-32 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-10">
                            <i data-lucide="database-zap" class="w-16 h-16 text-slate-200"></i>
                        </div>
                        <h3 class="text-3xl font-black text-slate-900 mb-4 tracking-tighter">ไม่พบข้อมูล หรือ กรุณาอัปโหลดไฟล์ CSV</h3>
                    </div>
                `;
                lucide.createIcons();
                return;
            }

            filtered.forEach(person => {
                const ageText = calculateAge(person.dob);
                const thumb = person.photoId ? `https://drive.google.com/thumbnail?id=${person.photoId}&sz=w600` : null;
                const full = person.photoId ? `https://drive.google.com/open?id=${person.photoId}` : null;
                const mapLink = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(person.workplace + ' สมุทรปราการ')}`;

                const card = document.createElement('div');
                card.className = "bg-white rounded-[4.5rem] shadow-sm flex flex-col group border border-slate-100 relative overflow-hidden text-left card-hover transition-all duration-700 animate-in fade-in slide-in-from-bottom-10";
                
                card.innerHTML = `
                    <div class="relative aspect-[3/4] m-5 rounded-[4rem] overflow-hidden bg-slate-50 shadow-inner ring-[15px] ring-white">
                        ${thumb ? `<img src="${thumb}" class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110">` : 
                        `<div class="w-full h-full flex flex-col items-center justify-center p-8 bg-slate-100">
                             <div class="w-32 h-32 bg-white rounded-full flex items-center justify-center text-7xl font-black text-emerald-600 mb-6 shadow-2xl border-4 border-emerald-50">${person.name.charAt(0)}</div>
                             <p class="text-[11px] font-black text-slate-400 tracking-widest uppercase">ID SECURE</p>
                         </div>`}
                        
                        ${full ? `
                        <div class="absolute inset-0 bg-emerald-950/80 opacity-0 group-hover:opacity-100 transition-all duration-500 flex flex-col items-center justify-center backdrop-blur-md p-10 translate-y-10 group-hover:translate-y-0">
                            <a href="${full}" target="_blank" class="bg-white text-emerald-900 px-12 py-6 rounded-[2.5rem] font-black text-sm shadow-2xl hover:bg-yellow-400 hover:scale-105 transition-all flex items-center gap-4">
                                <i data-lucide="image" class="w-6 h-6 text-emerald-600"></i> เปิดดูรูปต้นฉบับ
                            </a>
                        </div>` : ''}

                        <div class="absolute bottom-10 left-10">
                            <span class="px-7 py-3 bg-white/95 backdrop-blur-2xl rounded-full text-[12px] font-black uppercase tracking-[0.2em] text-emerald-900 shadow-2xl border border-white/50">${person.position}</span>
                        </div>
                    </div>

                    <div class="px-14 pb-20 pt-6 flex flex-col flex-grow">
                        <div class="mb-10">
                            <h2 class="text-4xl font-black text-slate-900 leading-[1.05] mb-5 group-hover:text-emerald-700 transition-colors tracking-tighter">${person.name} <br> ${person.surname}</h2>
                            <div class="flex flex-wrap gap-4 items-center">
                                ${person.nickname ? `<div class="bg-emerald-50 text-emerald-700 px-5 py-2.5 rounded-2xl text-[16px] font-black border border-emerald-100">หมอ${person.nickname}</div>` : ''}
                                <div class="bg-slate-50 text-slate-500 px-5 py-2.5 rounded-2xl text-[14px] font-bold border border-slate-100 italic">อายุ ${ageText}</div>
                            </div>
                        </div>

                        <div class="space-y-6 mb-12">
                            <div class="flex items-center gap-6 text-slate-500">
                                <div class="w-12 h-12 bg-slate-50 rounded-2xl flex items-center justify-center shrink-0 border border-slate-100"><i data-lucide="briefcase" class="w-6 h-6"></i></div>
                                <p class="text-[15px] font-bold uppercase tracking-tight">${person.type}</p>
                            </div>
                            <div class="flex items-center gap-6">
                                <div class="w-12 h-12 bg-emerald-50 rounded-2xl flex items-center justify-center shrink-0 border border-emerald-100 text-emerald-600"><i data-lucide="phone" class="w-6 h-6"></i></div>
                                <a href="tel:${person.phone}" class="text-xl font-black text-slate-800 hover:text-emerald-600 tracking-tight">${person.phone || "ไม่ระบุ"}</a>
                            </div>
                            <a href="${mapLink}" target="_blank" class="flex items-start gap-6 group/loc cursor-pointer p-4 -m-4 rounded-[2.5rem] hover:bg-emerald-50 transition-all">
                                <div class="w-12 h-12 bg-slate-50 rounded-2xl flex items-center justify-center shrink-0 border border-slate-100 text-emerald-500 group-hover/loc:bg-emerald-600 group-hover/loc:text-white transition-all shadow-sm"><i data-lucide="map-pin" class="w-6 h-6"></i></div>
                                <div class="flex-grow overflow-hidden">
                                    <p class="text-[14px] font-bold text-slate-500 leading-relaxed workplace-box uppercase tracking-tight">${person.workplace}</p>
                                    <span class="text-[10px] font-black text-emerald-600 opacity-0 group-hover/loc:opacity-100 uppercase tracking-widest mt-2 block">เปิด Google Maps →</span>
                                </div>
                            </a>
                        </div>

                        <div class="mt-auto">
                            ${full ? `
                            <a href="${full}" target="_blank" class="w-full py-7 bg-slate-900 text-white rounded-[2.8rem] flex items-center justify-center gap-6 text-[14px] font-black hover:bg-emerald-600 transition-all duration-700 shadow-xl active:scale-95 tracking-widest">
                                <i data-lucide="folder-search" class="w-6 h-6"></i> DRIVE SOURCE
                            </a>` : `
                            <button disabled class="w-full py-7 bg-slate-100 text-slate-300 rounded-[2.8rem] flex items-center justify-center gap-4 text-sm font-black cursor-not-allowed opacity-60">
                                <i data-lucide="lock" class="w-6 h-6"></i> ID NOT LINKED
                            </button>`}
                        </div>
                    </div>
                `;
                personnelGrid.appendChild(card);
            });
            lucide.createIcons();
        }

        searchInput.addEventListener('input', updateDisplay);
        workplaceFilter.addEventListener('change', updateDisplay);

        window.onload = () => {
            lucide.createIcons();
        };
    </script>
</body>
</html>