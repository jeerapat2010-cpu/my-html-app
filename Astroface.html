<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AstroFace - ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô‡πÇ‡∏´‡∏á‡∏ß‡πÄ‡∏Æ‡πâ‡∏á 3 ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700;800&display=swap');

        body {
            font-family: 'Prompt', sans-serif;
            background-color: #0a0514;
            color: white;
            overflow-x: hidden;
        }

        ::selection {
            background-color: rgba(168, 85, 247, 0.3);
        }

        @keyframes scan {
            0% { top: -5%; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: 105%; opacity: 0; }
        }
        .animate-scan {
            animation: scan 2.5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }
        
        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        .animate-marquee {
            display: inline-block;
            white-space: nowrap;
            animation: marquee 20s linear infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(2deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }
        .animate-float {
            animation: float 5s ease-in-out infinite;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        .text-gradient {
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Hide scrollbar for tabs if needed */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05); 
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(168, 85, 247, 0.5); 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(168, 85, 247, 0.8); 
        }

        .tab-btn.active {
            background: linear-gradient(to right, #9333ea, #4f46e5);
            color: white;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="min-h-screen relative">

    <!-- Mystical Background Elements -->
    <div class="fixed inset-0 z-0 overflow-hidden pointer-events-none">
        <div class="absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-purple-600/20 rounded-full blur-[120px] mix-blend-screen"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-indigo-600/20 rounded-full blur-[120px] mix-blend-screen"></div>
        <div class="absolute top-[40%] left-[50%] transform -translate-x-1/2 -translate-y-1/2 w-[60%] h-[60%] bg-fuchsia-600/10 rounded-full blur-[150px] mix-blend-screen"></div>
    </div>

    <!-- Marquee Info Bar -->
    <div class="relative z-10 bg-gradient-to-r from-purple-900/80 via-indigo-900/80 to-purple-900/80 border-b border-white/10 overflow-hidden py-2 backdrop-blur-sm">
        <div class="flex w-full overflow-hidden">
            <div class="animate-marquee flex gap-12 items-center text-sm font-medium tracking-wider text-purple-200">
                <span>‚ú® ‡∏ú‡∏™‡∏≤‡∏ô‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÇ‡∏´‡∏á‡∏ß‡πÄ‡∏Æ‡πâ‡∏á (‡∏à‡∏µ‡∏ô) ‚Ä¢ ‡∏ô‡∏£‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (‡πÑ‡∏ó‡∏¢) ‚Ä¢ ‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏¥‡∏Å‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢)</span>
                <span>üîÆ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏î‡πâ‡∏ß‡∏¢ AI ‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</span>
                <span>üåü ‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤ ‡∏ï‡∏≤ ‡∏à‡∏°‡∏π‡∏Å ‡∏´‡∏π ‡πÅ‡∏•‡∏∞‡∏£‡∏¥‡∏°‡∏ù‡∏µ‡∏õ‡∏≤‡∏Å</span>
                <span>‚ú® ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô ‡πÅ‡∏Å‡πâ‡∏à‡∏∏‡∏î‡∏î‡πâ‡∏≠‡∏¢ ‡∏û‡∏•‡∏¥‡∏Å‡∏ä‡∏∞‡∏ï‡∏≤‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå</span>
            </div>
        </div>
    </div>

    <!-- Camera Modal Overlay (Hidden by default) -->
    <div id="camera-modal" class="hidden fixed inset-0 z-50 bg-black/90 backdrop-blur-md flex flex-col items-center justify-center p-4">
        <div class="w-full max-w-md bg-white/5 border border-white/10 p-6 rounded-3xl flex flex-col items-center shadow-2xl shadow-purple-900/50">
            <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                <i data-lucide="camera" class="w-6 h-6 text-fuchsia-400"></i> ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á
            </h3>
            <div class="w-full aspect-[3/4] bg-black rounded-2xl overflow-hidden relative mb-6 border-2 border-fuchsia-500/30">
                <video id="camera-video" autoplay playsinline class="w-full h-full object-cover transform -scale-x-100"></video>
                <!-- Reference guide overlay -->
                <div class="absolute inset-0 border-[3px] border-dashed border-white/20 rounded-[40%] m-8 pointer-events-none"></div>
                <canvas id="camera-canvas" class="hidden"></canvas>
            </div>
            <div class="flex gap-4 w-full">
                <button onclick="stopCamera()" class="flex-1 py-4 rounded-2xl bg-white/10 hover:bg-white/20 text-white font-semibold transition-all">
                    ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                </button>
                <button onclick="capturePhoto()" class="flex-[2] py-4 rounded-2xl bg-gradient-to-r from-fuchsia-600 to-indigo-600 hover:from-fuchsia-500 hover:to-indigo-500 text-white font-bold shadow-lg shadow-purple-500/30 transition-all flex items-center justify-center gap-2">
                    <i data-lucide="camera" class="w-6 h-6"></i> ‡πÅ‡∏ä‡∏∞! ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="relative z-10 max-w-5xl mx-auto px-4 py-8 md:py-12 flex flex-col items-center">
        
        <!-- Header -->
        <div class="text-center mb-10 animate-float">
            <div class="inline-flex items-center justify-center p-3 bg-white/5 rounded-2xl border border-white/10 mb-4 backdrop-blur-md">
                <i data-lucide="scan-face" class="w-8 h-8 text-fuchsia-400 mr-3"></i>
                <h1 class="text-3xl md:text-5xl font-extrabold tracking-tight bg-gradient-to-r from-fuchsia-400 via-purple-400 to-indigo-400 text-gradient">
                    AstroFace
                </h1>
            </div>
            <p class="text-gray-300 max-w-xl mx-auto text-lg">
                ‡πÄ‡∏à‡πâ‡∏≤‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢ ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡∏ú‡∏°‡∏ú‡∏™‡∏≤‡∏ô 3 ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏´‡πà‡∏á‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß ‡∏™‡πÅ‡∏Å‡∏ô‡πÇ‡∏´‡∏á‡∏ß‡πÄ‡∏Æ‡πâ‡∏á‡πÅ‡∏ö‡∏ö‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö
            </p>
        </div>

        <!-- Error Message -->
        <div id="error-message" class="hidden w-full max-w-2xl bg-red-500/10 border border-red-500/50 rounded-xl p-4 mb-6 flex items-start gap-3 backdrop-blur-md">
            <i data-lucide="alert-circle" class="w-6 h-6 text-red-400 flex-shrink-0 mt-0.5"></i>
            <p id="error-text" class="text-red-200"></p>
        </div>

        <!-- Layout Grid -->
        <div class="w-full max-w-4xl grid grid-cols-1 md:grid-cols-12 gap-8">
            
            <!-- Left Column: Image Area -->
            <div id="left-column" class="col-span-1 md:col-span-12 max-w-md mx-auto w-full transition-all duration-500">
                <div class="glass-panel rounded-3xl p-2 relative group overflow-hidden">
                    
                    <!-- Upload & Camera State -->
                    <div id="upload-state" class="flex flex-col gap-3 h-full p-2">
                        <div onclick="document.getElementById('file-input').click()" class="flex-1 border-2 border-dashed border-purple-500/30 rounded-2xl aspect-[4/3] flex flex-col items-center justify-center p-6 text-center cursor-pointer hover:bg-purple-500/5 hover:border-purple-400 transition-all duration-300">
                            <div class="w-16 h-16 bg-purple-500/20 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                                <i data-lucide="upload" class="w-8 h-8 text-purple-300"></i>
                            </div>
                            <h3 class="text-lg font-bold text-white mb-1">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á</h3>
                            <p class="text-xs text-gray-400">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö JPG, PNG</p>
                            <input type="file" id="file-input" accept="image/*" class="hidden" onchange="handleImageUpload(event)">
                        </div>
                        
                        <div class="flex items-center gap-4 w-full px-2 py-1">
                            <div class="flex-1 h-px bg-white/10"></div>
                            <span class="text-xs font-medium text-gray-400">‡∏´‡∏£‡∏∑‡∏≠</span>
                            <div class="flex-1 h-px bg-white/10"></div>
                        </div>

                        <button onclick="startCamera()" class="w-full bg-gradient-to-r from-purple-600/20 to-indigo-600/20 hover:from-purple-600/40 hover:to-indigo-600/40 border border-purple-500/30 text-purple-100 font-bold py-4 px-6 rounded-2xl transition-all flex items-center justify-center gap-3 group/btn">
                            <div class="bg-purple-500/20 p-2 rounded-full group-hover/btn:scale-110 transition-transform">
                                <i data-lucide="camera" class="w-6 h-6 text-fuchsia-400"></i>
                            </div>
                            ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á
                        </button>
                    </div>

                    <!-- Image Preview State (Hidden by default) -->
                    <div id="preview-state" class="hidden relative rounded-2xl overflow-hidden aspect-[3/4] bg-black">
                        <img id="preview-image" src="" alt="Face to analyze" class="w-full h-full object-cover transition-all duration-700" />
                        
                        <!-- Scanning Animation (Hidden by default) -->
                        <div id="scanning-animation" class="hidden">
                            <div class="absolute inset-0 bg-gradient-to-b from-transparent via-fuchsia-500/20 to-transparent animate-scan w-full h-[20%] border-y border-fuchsia-400/50 blur-[2px] z-20"></div>
                            <div class="absolute inset-0 flex flex-col items-center justify-center z-30">
                                <i data-lucide="loader-2" class="w-12 h-12 text-fuchsia-400 animate-spin mb-4"></i>
                                <p class="text-fuchsia-300 font-medium text-lg tracking-widest animate-pulse drop-shadow-md">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏™‡∏≤‡∏ô 3 ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...</p>
                            </div>
                            <div class="absolute inset-0 z-10 opacity-30" style="background-image: linear-gradient(rgba(255, 255, 255, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.1) 1px, transparent 1px); background-size: 20px 20px;"></div>
                        </div>
                        
                        <!-- Overlay for Action (Hidden when scanning) -->
                        <div id="action-overlay" class="absolute inset-0 bg-black/60 opacity-0 hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-4">
                            <button onclick="analyzeFace()" class="bg-gradient-to-r from-fuchsia-600 to-indigo-600 hover:from-fuchsia-500 hover:to-indigo-500 text-white font-bold py-3 px-6 rounded-full shadow-lg shadow-purple-500/30 transform hover:scale-105 transition-all flex items-center gap-2">
                                <i data-lucide="sparkles" class="w-5 h-5"></i>
                                ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô‡πÇ‡∏´‡∏á‡∏ß‡πÄ‡∏Æ‡πâ‡∏á
                            </button>
                            <button onclick="resetApp()" class="text-gray-300 hover:text-white text-sm underline flex items-center gap-1">
                                <i data-lucide="refresh-cw" class="w-4 h-4"></i> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ
                            </button>
                        </div>
                        
                        <!-- Close Button (Visible when results show) -->
                        <button id="close-preview-btn" onclick="resetApp()" class="hidden absolute top-4 right-4 bg-black/50 hover:bg-black/80 p-2 rounded-full backdrop-blur-md transition-colors z-40">
                            <i data-lucide="x" class="w-5 h-5 text-white"></i>
                        </button>
                    </div>
                </div>
                
                <div id="click-hint" class="hidden mt-6 text-center animate-pulse">
                    <p class="text-purple-300">‡∏ô‡∏≥‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÑ‡∏õ‡∏ä‡∏µ‡πâ‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö!</p>
                </div>
            </div>

            <!-- Right Column: Results Area (Hidden by default) -->
            <div id="results-area" class="hidden col-span-1 md:col-span-7 flex flex-col gap-6 animate-in fade-in slide-in-from-bottom-8 duration-700">
                
                <!-- Header Result Card -->
                <div class="glass-panel rounded-3xl p-6 relative overflow-hidden border-t border-t-fuchsia-400/30">
                    <div class="absolute top-0 right-0 p-4 opacity-20">
                        <i data-lucide="star" class="w-24 h-24 text-fuchsia-400"></i>
                    </div>
                    <div class="relative z-10">
                        <div id="res-ascendant" class="inline-block px-3 py-1 bg-fuchsia-500/20 text-fuchsia-300 rounded-full text-sm font-semibold mb-3 border border-fuchsia-500/30">
                            <!-- Ascendant -->
                        </div>
                        <h2 id="res-summary" class="text-2xl md:text-3xl font-bold text-white mb-2 leading-snug">
                            <!-- Summary -->
                        </h2>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="flex bg-white/5 p-1 rounded-2xl backdrop-blur-sm">
                    <button onclick="switchTab('features')" id="tab-features" class="tab-btn active flex-1 py-3 text-sm font-semibold rounded-xl transition-all text-gray-400 hover:text-white hover:bg-white/5">
                        ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏≠‡∏ß‡∏±‡∏¢‡∏ß‡∏∞
                    </button>
                    <button onclick="switchTab('traits')" id="tab-traits" class="tab-btn flex-1 py-3 text-sm font-semibold rounded-xl transition-all text-gray-400 hover:text-white hover:bg-white/5">
                        ‡∏ô‡∏¥‡∏™‡∏±‡∏¢ & ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô
                    </button>
                    <button onclick="switchTab('guide')" id="tab-guide" class="tab-btn flex-1 py-3 text-sm font-semibold rounded-xl transition-all text-gray-400 hover:text-white hover:bg-white/5">
                        ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤
                    </button>
                </div>

                <!-- Tab Content: Features -->
                <div id="content-features" class="grid grid-cols-1 gap-4 animate-in fade-in duration-500">
                    <!-- Injected via JS -->
                </div>

                <!-- Tab Content: Traits -->
                <div id="content-traits" class="hidden flex flex-col gap-4 animate-in fade-in duration-500">
                    <div class="glass-panel p-6 rounded-2xl">
                        <h3 class="text-xl font-bold text-white mb-3 flex items-center gap-2">
                            <i data-lucide="sparkles" class="w-5 h-5 text-purple-400"></i> ‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á
                        </h3>
                        <p id="res-personality" class="text-gray-300 leading-relaxed text-sm md:text-base"></p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="glass-panel p-6 rounded-2xl border-t border-t-emerald-500/30">
                            <h3 class="text-lg font-bold text-emerald-300 mb-4 flex items-center gap-2">
                                <i data-lucide="check-circle-2" class="w-5 h-5"></i> ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô (Strengths)
                            </h3>
                            <ul id="res-strengths" class="space-y-3"></ul>
                        </div>
                        
                        <div class="glass-panel p-6 rounded-2xl border-t border-t-rose-500/30">
                            <h3 class="text-lg font-bold text-rose-300 mb-4 flex items-center gap-2">
                                <i data-lucide="alert-circle" class="w-5 h-5"></i> ‡∏à‡∏∏‡∏î‡∏î‡πâ‡∏≠‡∏¢ (Weaknesses)
                            </h3>
                            <ul id="res-weaknesses" class="space-y-3"></ul>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Guide -->
                <div id="content-guide" class="hidden glass-panel p-6 rounded-2xl border-l-4 border-l-fuchsia-500 animate-in fade-in duration-500 relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-fuchsia-500/10 rounded-full blur-2xl"></div>
                    <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2 relative z-10">
                        <i data-lucide="star" class="w-6 h-6 text-fuchsia-400 fill-fuchsia-400"></i> ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤
                    </h3>
                    <div class="bg-white/5 rounded-xl p-5 relative z-10 border border-white/10">
                        <p id="res-guide" class="text-gray-200 leading-relaxed text-lg"></p>
                    </div>
                    
                    <div class="mt-6 flex justify-end relative z-10">
                        <button onclick="alert('‡πÄ‡∏à‡πâ‡∏≤‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÅ‡∏ä‡∏£‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÉ‡∏ô‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üöÄ')" class="text-sm px-4 py-2 bg-purple-600/30 hover:bg-purple-600/50 text-purple-200 rounded-lg transition-colors flex items-center gap-2">
                            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Application Logic -->
    <script>
        // Initialize Icons
        lucide.createIcons();

        // State Variables
        let currentBase64Image = null;
        let currentMimeType = null;
        let mediaStream = null;
        const apiKey = ""; // Keep empty as requested, relying on the environment or fallback.

        // DOM Elements
        const errorContainer = document.getElementById('error-message');
        const errorText = document.getElementById('error-text');
        
        const uploadState = document.getElementById('upload-state');
        const previewState = document.getElementById('preview-state');
        const previewImage = document.getElementById('preview-image');
        const clickHint = document.getElementById('click-hint');
        
        const scanningAnimation = document.getElementById('scanning-animation');
        const actionOverlay = document.getElementById('action-overlay');
        const closePreviewBtn = document.getElementById('close-preview-btn');
        
        const leftColumn = document.getElementById('left-column');
        const resultsArea = document.getElementById('results-area');
        
        const cameraModal = document.getElementById('camera-modal');
        const cameraVideo = document.getElementById('camera-video');
        const cameraCanvas = document.getElementById('camera-canvas');

        // Helpers
        function showError(msg) {
            errorText.innerText = msg;
            errorContainer.classList.remove('hidden');
        }
        function hideError() {
            errorContainer.classList.add('hidden');
        }

        // --- File Upload ---
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                if (!file.type.startsWith('image/')) {
                    showError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏ô‡∏≤‡∏¢');
                    return;
                }
                
                const reader = new FileReader();
                reader.onloadend = () => {
                    setupImagePreview(reader.result, file.type);
                };
                reader.readAsDataURL(file);
            }
        }

        // --- Camera Functions ---
        async function startCamera() {
            try {
                mediaStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: 'user' } 
                });
                cameraModal.classList.remove('hidden');
                cameraVideo.srcObject = mediaStream;
                hideError();
            } catch (err) {
                console.error("Camera error:", err);
                showError("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏ô‡∏≤‡∏¢ ‡∏•‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏î‡∏π‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö");
            }
        }

        function stopCamera() {
            if (mediaStream) {
                mediaStream.getTracks().forEach(track => track.stop());
                mediaStream = null;
            }
            cameraModal.classList.add('hidden');
        }

        function capturePhoto() {
            if (cameraVideo.srcObject) {
                cameraCanvas.width = cameraVideo.videoWidth;
                cameraCanvas.height = cameraVideo.videoHeight;
                const context = cameraCanvas.getContext('2d');
                
                // Flip mirror
                context.translate(cameraCanvas.width, 0);
                context.scale(-1, 1);
                context.drawImage(cameraVideo, 0, 0, cameraCanvas.width, cameraCanvas.height);

                const dataUrl = cameraCanvas.toDataURL('image/jpeg');
                setupImagePreview(dataUrl, 'image/jpeg');
                stopCamera();
            }
        }

        // --- Shared Setup ---
        function setupImagePreview(dataUrl, mimeType) {
            previewImage.src = dataUrl;
            currentBase64Image = dataUrl.split(',')[1];
            currentMimeType = mimeType;
            
            uploadState.classList.add('hidden');
            previewState.classList.remove('hidden');
            clickHint.classList.remove('hidden');
            hideError();
        }

        function resetApp() {
            currentBase64Image = null;
            currentMimeType = null;
            
            previewImage.src = '';
            document.getElementById('file-input').value = '';
            
            uploadState.classList.remove('hidden');
            previewState.classList.add('hidden');
            clickHint.classList.add('hidden');
            resultsArea.classList.add('hidden');
            
            leftColumn.classList.replace('md:col-span-5', 'md:col-span-12');
            actionOverlay.classList.remove('hidden');
            closePreviewBtn.classList.add('hidden');
            previewImage.classList.remove('scale-105', 'blur-sm', 'brightness-50');
            
            hideError();
        }

        // --- Analysis Logic ---
        async function analyzeFace() {
            if (!currentBase64Image) return;

            // UI Loading state
            scanningAnimation.classList.remove('hidden');
            actionOverlay.classList.add('hidden');
            clickHint.classList.add('hidden');
            previewImage.classList.add('scale-105', 'blur-sm', 'brightness-50');
            hideError();

            const prompt = `
                ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏õ‡∏£‡∏°‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏î‡πâ‡∏≤‡∏ô ‡πÇ‡∏´‡∏á‡∏ß‡πÄ‡∏Æ‡πâ‡∏á (‡∏à‡∏µ‡∏ô), ‡∏ô‡∏£‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (‡πÑ‡∏ó‡∏¢) ‡πÅ‡∏•‡∏∞ ‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏¥‡∏Å‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢)
                ‡∏à‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏π‡∏õ‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ô‡∏¥‡∏™‡∏±‡∏¢ ‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á ‡∏à‡∏∏‡∏î‡∏≠‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ ‡πÇ‡∏î‡∏¢‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏±‡∏Ñ‡∏ô‡∏≤‡πÅ‡∏•‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤
                
                ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô JSON FORMAT ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ (‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î):
                {
                    "ascendant": "‡∏•‡∏±‡∏Ñ‡∏ô‡∏≤/‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÑ‡∏î‡πâ (‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡∏±‡∏Ñ‡∏ô‡∏≤‡∏™‡∏¥‡∏á‡∏´‡πå ‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü)",
                    "summary": "‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏´‡∏á‡∏ß‡πÄ‡∏Æ‡πâ‡∏á‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à",
                    "features": {
                        "faceShape": { "feature": "‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤...", "reading": "‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢...", "origin": "‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå..." },
                        "eyes": { "feature": "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ï‡∏≤...", "reading": "‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢...", "origin": "‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå..." },
                        "nose": { "feature": "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏à‡∏°‡∏π‡∏Å...", "reading": "‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢...", "origin": "‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå..." },
                        "ears": { "feature": "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏´‡∏π...", "reading": "‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢...", "origin": "‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå..." },
                        "lips": { "feature": "‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏£‡∏¥‡∏°‡∏ù‡∏µ‡∏õ‡∏≤‡∏Å...", "reading": "‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢...", "origin": "‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå..." }
                    },
                    "personality": "‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å",
                    "strengths": ["‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1", "‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 2", "‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 3"],
                    "weaknesses": ["‡∏Ç‡πâ‡∏≠‡∏î‡πâ‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1", "‡∏Ç‡πâ‡∏≠‡∏î‡πâ‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 2", "‡∏Ç‡πâ‡∏≠‡∏î‡πâ‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 3"],
                    "developmentGuide": "‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏î‡∏ß‡∏á"
                }
            `;

            try {
                let retryCount = 0;
                let success = false;
                let data = null;

                while (retryCount < 3 && !success) {
                    try {
                        const response = await fetch(
                            `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
                            {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    contents: [{ role: "user", parts: [{ text: prompt }, { inlineData: { mimeType: currentMimeType || "image/jpeg", data: currentBase64Image } }] }],
                                    generationConfig: { responseMimeType: "application/json" }
                                })
                            }
                        );

                        if (!response.ok) throw new Error('API Request Failed');
                        
                        const jsonResponse = await response.json();
                        const textResponse = jsonResponse.candidates?.[0]?.content?.parts?.[0]?.text;
                        
                        if (textResponse) {
                            data = JSON.parse(textResponse);
                            success = true;
                        } else {
                            throw new Error('Invalid response format');
                        }
                    } catch (err) {
                        retryCount++;
                        if (retryCount >= 3) throw err;
                        await new Promise(r => setTimeout(r, Math.pow(2, retryCount) * 1000));
                    }
                }
                renderResults(data);
            } catch (err) {
                console.error(err);
                // Fallback Mock Data
                showError("‡∏£‡∏∞‡∏ö‡∏ö AI ‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏±‡∏Å‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏™‡πà API Key ‡πÅ‡∏ï‡πà‡∏ú‡∏°‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏ô‡∏≤‡∏¢!");
                renderResults({
                    "ascendant": "‡∏•‡∏±‡∏Ñ‡∏ô‡∏≤‡∏û‡∏¥‡∏à‡∏¥‡∏Å ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥‡∏ú‡∏™‡∏°‡πÑ‡∏ü (‡∏™‡πÄ‡∏ô‡πà‡∏´‡πå‡∏•‡∏∂‡∏Å‡∏•‡∏±‡∏ö)",
                    "summary": "‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏´‡πà‡∏á‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏ö‡∏≤‡∏£‡∏°‡∏µ‡πÅ‡∏•‡∏∞‡πÑ‡∏´‡∏ß‡∏û‡∏£‡∏¥‡∏ö ‡∏ú‡∏™‡∏≤‡∏ô‡∏û‡∏•‡∏±‡∏á‡∏´‡∏¢‡∏¥‡∏ô‡∏´‡∏¢‡∏≤‡∏á‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏á‡∏ï‡∏±‡∏ß",
                    "features": {
                        "faceShape": { "feature": "‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏£‡∏á‡∏ú‡∏™‡∏° (‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡πÅ‡∏•‡∏∞‡∏°‡∏ô)", "reading": "‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î‡πÅ‡∏ï‡πà‡πÅ‡∏ù‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏ô‡∏µ‡∏õ‡∏£‡∏∞‡∏ô‡∏≠‡∏° ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏¢‡∏≠‡∏î", "origin": "‡∏ô‡∏£‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (‡πÑ‡∏ó‡∏¢)" },
                        "eyes": { "feature": "‡∏ï‡∏≤‡∏´‡∏á‡∏™‡πå ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÅ‡∏ß‡∏ß‡∏ß‡∏≤‡∏ß", "reading": "‡∏°‡∏µ‡πÄ‡∏™‡∏ô‡πà‡∏´‡πå‡∏î‡∏∂‡∏á‡∏î‡∏π‡∏î‡πÉ‡∏à ‡∏â‡∏•‡∏≤‡∏î‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏´‡∏•‡∏° ‡∏°‡∏≠‡∏á‡∏Ñ‡∏ô‡∏ó‡∏∞‡∏•‡∏∏‡∏õ‡∏£‡∏∏‡πÇ‡∏õ‡∏£‡πà‡∏á", "origin": "‡πÇ‡∏´‡∏á‡∏ß‡πÄ‡∏Æ‡πâ‡∏á (‡∏à‡∏µ‡∏ô)" },
                        "nose": { "feature": "‡∏™‡∏±‡∏ô‡∏à‡∏°‡∏π‡∏Å‡∏ï‡∏£‡∏á ‡∏õ‡∏•‡∏≤‡∏¢‡∏≠‡∏¥‡πà‡∏°‡πÄ‡∏ï‡πá‡∏°", "reading": "‡∏´‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡πà‡∏á ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏µ‡∏î‡πâ‡∏ß‡∏¢‡∏•‡∏≥‡πÅ‡∏Ç‡πâ‡∏á‡∏ï‡∏ô‡πÄ‡∏≠‡∏á", "origin": "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏¥‡∏Å‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢)" },
                        "ears": { "feature": "‡∏ï‡∏¥‡πà‡∏á‡∏´‡∏π‡∏´‡∏ô‡∏≤ ‡∏Ç‡∏≠‡∏ö‡∏´‡∏π‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô", "reading": "‡∏≠‡∏≤‡∏¢‡∏∏‡∏¢‡∏∑‡∏ô ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á ‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà‡∏≠‡∏∏‡∏õ‡∏ñ‡∏±‡∏°‡∏†‡πå‡∏Ñ‡πâ‡∏≥‡∏ä‡∏π", "origin": "‡πÇ‡∏´‡∏á‡∏ß‡πÄ‡∏Æ‡πâ‡∏á (‡∏à‡∏µ‡∏ô)" },
                        "lips": { "feature": "‡∏£‡∏¥‡∏°‡∏ù‡∏µ‡∏õ‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡∏à‡∏±‡∏ö ‡∏°‡∏∏‡∏°‡∏õ‡∏≤‡∏Å‡∏¢‡∏Å", "reading": "‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏û‡∏≤‡∏ó‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏¥‡∏® ‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡πÇ‡∏ô‡πâ‡∏°‡∏ô‡πâ‡∏≤‡∏ß‡πÉ‡∏à‡∏Ñ‡∏ô‡πÄ‡∏Å‡πà‡∏á", "origin": "‡∏ô‡∏£‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (‡πÑ‡∏ó‡∏¢)" }
                    },
                    "personality": "‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏™‡∏π‡∏á ‡∏ó‡∏∞‡πÄ‡∏¢‡∏≠‡∏ó‡∏∞‡∏¢‡∏≤‡∏ô ‡πÅ‡∏ï‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô‡πÑ‡∏ß‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡∏ä‡∏≠‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏´‡∏°‡πà‡πÜ ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏´‡∏Å‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ ‡∏°‡∏±‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏∂‡πà‡∏á‡∏û‡∏≤‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏°‡∏≠",
                    "strengths": ["‡πÑ‡∏´‡∏ß‡∏û‡∏£‡∏¥‡∏ö‡∏î‡∏µ ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡πà‡∏á", "‡∏°‡∏µ‡πÄ‡∏™‡∏ô‡πà‡∏´‡πå‡∏ó‡∏≤‡∏á‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡∏ï‡∏±‡∏ß", "‡∏°‡∏∏‡πà‡∏á‡∏°‡∏±‡πà‡∏ô ‡πÑ‡∏°‡πà‡∏¢‡∏≠‡∏°‡πÅ‡∏û‡πâ‡∏≠‡∏∞‡πÑ‡∏£‡∏á‡πà‡∏≤‡∏¢‡πÜ"],
                    "weaknesses": ["‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏î‡∏∑‡πâ‡∏≠‡∏£‡∏±‡πâ‡∏ô ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡πÑ‡∏õ", "‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÄ‡∏Å‡πà‡∏á‡∏à‡∏ô‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡∏™‡∏∞‡∏™‡∏°", "‡∏Ç‡∏µ‡πâ‡πÄ‡∏ö‡∏∑‡πà‡∏≠ ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤"],
                    "developmentGuide": "‡∏Ñ‡∏ß‡∏£‡∏ù‡∏∂‡∏Å‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏£‡∏∏‡πà‡∏°‡πÉ‡∏ô‡πÉ‡∏à ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏î‡∏ß‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ß‡∏°‡πÉ‡∏™‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏µ‡πÇ‡∏ó‡∏ô‡πÄ‡∏¢‡πá‡∏ô (‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô, ‡∏°‡πà‡∏ß‡∏á) ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏à‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏±‡∏á‡∏ö‡∏≤‡∏£‡∏°‡∏µ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏ö‡∏ö‡πÑ‡∏£‡πâ‡∏ó‡∏µ‡πà‡∏ï‡∏¥"
                });
            } finally {
                scanningAnimation.classList.add('hidden');
                closePreviewBtn.classList.remove('hidden');
            }
        }

        // --- Render Results ---
        function renderResults(data) {
            // Adjust Layout
            leftColumn.classList.replace('md:col-span-12', 'md:col-span-5');
            resultsArea.classList.remove('hidden');
            switchTab('features');

            // Header info
            document.getElementById('res-ascendant').innerText = data.ascendant;
            document.getElementById('res-summary').innerText = data.summary;

            // Features Tab
            const featuresHTML = `
                ${createFeatureCard('scan-face', '‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤ (Face Shape)', data.features.faceShape, 'cyan')}
                ${createFeatureCard('eye', '‡∏î‡∏ß‡∏á‡∏ï‡∏≤ (Eyes)', data.features.eyes, 'indigo')}
                ${createFeatureCard('activity', '‡∏à‡∏°‡∏π‡∏Å (Nose)', data.features.nose, 'amber')}
                ${createFeatureCard('ear', '‡πÉ‡∏ö‡∏´‡∏π (Ears)', data.features.ears, 'emerald')}
                ${createFeatureCard('smile', '‡∏£‡∏¥‡∏°‡∏ù‡∏µ‡∏õ‡∏≤‡∏Å (Lips)', data.features.lips, 'rose')}
            `;
            document.getElementById('content-features').innerHTML = featuresHTML;

            // Traits Tab
            document.getElementById('res-personality').innerText = data.personality;
            
            document.getElementById('res-strengths').innerHTML = data.strengths.map(s => 
                `<li class="flex items-start gap-2 text-sm text-gray-300"><span class="text-emerald-400 mt-1">‚Ä¢</span><span>${s}</span></li>`
            ).join('');
            
            document.getElementById('res-weaknesses').innerHTML = data.weaknesses.map(w => 
                `<li class="flex items-start gap-2 text-sm text-gray-300"><span class="text-rose-400 mt-1">‚Ä¢</span><span>${w}</span></li>`
            ).join('');

            // Guide Tab
            document.getElementById('res-guide').innerText = data.developmentGuide;

            // Re-initialize icons for newly added HTML
            lucide.createIcons();
        }

        function createFeatureCard(iconName, title, data, color) {
            const colors = {
                cyan: 'bg-cyan-500/10 border-cyan-500/20 text-cyan-300',
                indigo: 'bg-indigo-500/10 border-indigo-500/20 text-indigo-300',
                amber: 'bg-amber-500/10 border-amber-500/20 text-amber-300',
                emerald: 'bg-emerald-500/10 border-emerald-500/20 text-emerald-300',
                rose: 'bg-rose-500/10 border-rose-500/20 text-rose-300'
            };
            
            return `
                <div class="glass-panel p-4 rounded-2xl flex flex-col md:flex-row gap-4 items-start md:items-center hover:bg-white/10 transition-colors duration-300">
                    <div class="p-3 rounded-xl flex-shrink-0 border ${colors[color]}">
                        <i data-lucide="${iconName}" class="w-5 h-5 currentColor"></i>
                    </div>
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-1">
                            <h4 class="font-bold text-white">${title}</h4>
                            <span class="text-[10px] uppercase px-2 py-0.5 rounded-full bg-white/10 text-gray-300 tracking-wider">
                                ${data.origin}
                            </span>
                        </div>
                        <p class="text-sm font-medium text-purple-200 mb-1">‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞: ${data.feature}</p>
                        <p class="text-sm text-gray-400">${data.reading}</p>
                    </div>
                </div>
            `;
        }

        // --- Tabs Logic ---
        function switchTab(tabId) {
            // Reset all tabs & contents
            ['features', 'traits', 'guide'].forEach(id => {
                document.getElementById(`tab-${id}`).classList.remove('active');
                document.getElementById(`content-${id}`).classList.add('hidden');
            });
            
            // Activate selected
            document.getElementById(`tab-${tabId}`).classList.add('active');
            document.getElementById(`content-${tabId}`).classList.remove('hidden');
        }

    </script>
</body>
</html>